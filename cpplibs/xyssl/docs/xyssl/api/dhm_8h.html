<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>xyssl: include/xyssl/dhm.h File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.3 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li class="current"><a href="files.html"><span>Files</span></a></li>
  </ul>
</div>
<h1>include/xyssl/dhm.h File Reference</h1><code>#include &quot;<a class="el" href="bignum_8h-source.html">xyssl/bignum.h</a>&quot;</code><br>

<p>
<div class="dynheader">
Include dependency graph for dhm.h:</div>
<div class="dynsection">
<p><center><img src="dhm_8h__incl.png" border="0" usemap="#include/xyssl/dhm.h_map" alt=""></center>
<map name="include/xyssl/dhm.h_map">
<area shape="rect" href="bignum_8h.html" title="xyssl/bignum.h" alt="" coords="23,84,149,108"></map>
</div>

<p>
<div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dynsection">
<p><center><img src="dhm_8h__dep__incl.png" border="0" usemap="#include/xyssl/dhm.hdep_map" alt=""></center>
<map name="include/xyssl/dhm.hdep_map">
<area shape="rect" href="ssl_8h.html" title="include/xyssl/ssl.h" alt="" coords="14,83,158,107"></map>
</div>

<p>
<a href="dhm_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><b>dhm_context</b></td></tr>

<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0e44a01bdea4729a1dd5957f2ce0f4bf"></a><!-- doxytag: member="dhm.h::XYSSL_ERR_DHM_BAD_INPUT_DATA" ref="0e44a01bdea4729a1dd5957f2ce0f4bf" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>XYSSL_ERR_DHM_BAD_INPUT_DATA</b>&nbsp;&nbsp;&nbsp;-0x0480</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3591a75de735a07b56a793e4e03bb4fd"></a><!-- doxytag: member="dhm.h::XYSSL_ERR_DHM_READ_PARAMS_FAILED" ref="3591a75de735a07b56a793e4e03bb4fd" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>XYSSL_ERR_DHM_READ_PARAMS_FAILED</b>&nbsp;&nbsp;&nbsp;-0x0490</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f0260679f0b581252e2138a22a955345"></a><!-- doxytag: member="dhm.h::XYSSL_ERR_DHM_MAKE_PARAMS_FAILED" ref="f0260679f0b581252e2138a22a955345" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>XYSSL_ERR_DHM_MAKE_PARAMS_FAILED</b>&nbsp;&nbsp;&nbsp;-0x04A0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e2a0621981a562a5f4fdbdc4cac4cbdd"></a><!-- doxytag: member="dhm.h::XYSSL_ERR_DHM_READ_PUBLIC_FAILED" ref="e2a0621981a562a5f4fdbdc4cac4cbdd" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>XYSSL_ERR_DHM_READ_PUBLIC_FAILED</b>&nbsp;&nbsp;&nbsp;-0x04B0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="eca0a5c63e2e6450b111fd64ede957d0"></a><!-- doxytag: member="dhm.h::XYSSL_ERR_DHM_MAKE_PUBLIC_FAILED" ref="eca0a5c63e2e6450b111fd64ede957d0" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>XYSSL_ERR_DHM_MAKE_PUBLIC_FAILED</b>&nbsp;&nbsp;&nbsp;-0x04C0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="583d57be67568b011ed148f156c5494e"></a><!-- doxytag: member="dhm.h::XYSSL_ERR_DHM_CALC_SECRET_FAILED" ref="583d57be67568b011ed148f156c5494e" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>XYSSL_ERR_DHM_CALC_SECRET_FAILED</b>&nbsp;&nbsp;&nbsp;-0x04D0</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dhm_8h.html#2be02700ad43f1e31e579f6d8412bf7e">dhm_read_params</a> (dhm_context *ctx, unsigned char **p, unsigned char *end)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Parse the ServerKeyExchange parameters.  <a href="#2be02700ad43f1e31e579f6d8412bf7e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dhm_8h.html#fb1d920279409249a8d6ae71a2dfab62">dhm_make_params</a> (dhm_context *ctx, int s_size, unsigned char *output, int *olen, int(*f_rng)(void *), void *p_rng)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Setup and write the ServerKeyExchange parameters.  <a href="#fb1d920279409249a8d6ae71a2dfab62"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dhm_8h.html#8471f39aeeef841a4984f844debb2186">dhm_read_public</a> (dhm_context *ctx, unsigned char *input, int ilen)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Import the peer's public value G^Y.  <a href="#8471f39aeeef841a4984f844debb2186"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dhm_8h.html#93c83931e8f3c818274834dfc435a4c4">dhm_make_public</a> (dhm_context *ctx, int s_size, unsigned char *output, int olen, int(*f_rng)(void *), void *p_rng)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create own private value X and export G^X.  <a href="#93c83931e8f3c818274834dfc435a4c4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dhm_8h.html#116df37d64349118c538da74a5a9e6fe">dhm_calc_secret</a> (dhm_context *ctx, unsigned char *output, int *olen)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Derive and export the shared secret (G^Y)^X mod P.  <a href="#116df37d64349118c538da74a5a9e6fe"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="da3c785f695c3d513177dd45d3c6f254"></a><!-- doxytag: member="dhm.h::dhm_free" ref="da3c785f695c3d513177dd45d3c6f254" args="(dhm_context *ctx)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>dhm_free</b> (dhm_context *ctx)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="dhm_8h.html#61cc4f6b8b132f50e34b6f42b74d08fa">dhm_self_test</a> (int verbose)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Checkup routine.  <a href="#61cc4f6b8b132f50e34b6f42b74d08fa"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="116df37d64349118c538da74a5a9e6fe"></a><!-- doxytag: member="dhm.h::dhm_calc_secret" ref="116df37d64349118c538da74a5a9e6fe" args="(dhm_context *ctx, unsigned char *output, int *olen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dhm_calc_secret           </td>
          <td>(</td>
          <td class="paramtype">dhm_context *&nbsp;</td>
          <td class="paramname"> <em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>olen</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Derive and export the shared secret (G^Y)^X mod P. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ctx</em>&nbsp;</td><td>DHM context </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>output</em>&nbsp;</td><td>destination buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>olen</em>&nbsp;</td><td>number of chars written</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 if successful, or an XYSSL_ERR_DHM_XXX error code </dd></dl>

</div>
</div><p>
<a class="anchor" name="fb1d920279409249a8d6ae71a2dfab62"></a><!-- doxytag: member="dhm.h::dhm_make_params" ref="fb1d920279409249a8d6ae71a2dfab62" args="(dhm_context *ctx, int s_size, unsigned char *output, int *olen, int(*f_rng)(void *), void *p_rng)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dhm_make_params           </td>
          <td>(</td>
          <td class="paramtype">dhm_context *&nbsp;</td>
          <td class="paramname"> <em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>s_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>olen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *)&nbsp;</td>
          <td class="paramname"> <em>f_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>p_rng</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Setup and write the ServerKeyExchange parameters. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ctx</em>&nbsp;</td><td>DHM context </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>x_size</em>&nbsp;</td><td>private value size in bits </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>output</em>&nbsp;</td><td>destination buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>olen</em>&nbsp;</td><td>number of chars written </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>f_rng</em>&nbsp;</td><td>RNG function </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>p_rng</em>&nbsp;</td><td>RNG parameter</td></tr>
  </table>
</dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd>This function assumes that ctx-&gt;P and ctx-&gt;G have already been properly set (for example using mpi_read_string or mpi_read_binary).</dd></dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 if successful, or an XYSSL_ERR_DHM_XXX error code </dd></dl>

</div>
</div><p>
<a class="anchor" name="93c83931e8f3c818274834dfc435a4c4"></a><!-- doxytag: member="dhm.h::dhm_make_public" ref="93c83931e8f3c818274834dfc435a4c4" args="(dhm_context *ctx, int s_size, unsigned char *output, int olen, int(*f_rng)(void *), void *p_rng)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dhm_make_public           </td>
          <td>(</td>
          <td class="paramtype">dhm_context *&nbsp;</td>
          <td class="paramname"> <em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>s_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>olen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *)&nbsp;</td>
          <td class="paramname"> <em>f_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>p_rng</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create own private value X and export G^X. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ctx</em>&nbsp;</td><td>DHM context </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>x_size</em>&nbsp;</td><td>private value size in bits </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>output</em>&nbsp;</td><td>destination buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>olen</em>&nbsp;</td><td>must be equal to ctx-&gt;P.len </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>f_rng</em>&nbsp;</td><td>RNG function </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>p_rng</em>&nbsp;</td><td>RNG parameter</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 if successful, or an XYSSL_ERR_DHM_XXX error code </dd></dl>

</div>
</div><p>
<a class="anchor" name="2be02700ad43f1e31e579f6d8412bf7e"></a><!-- doxytag: member="dhm.h::dhm_read_params" ref="2be02700ad43f1e31e579f6d8412bf7e" args="(dhm_context *ctx, unsigned char **p, unsigned char *end)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dhm_read_params           </td>
          <td>(</td>
          <td class="paramtype">dhm_context *&nbsp;</td>
          <td class="paramname"> <em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char **&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>end</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Parse the ServerKeyExchange parameters. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ctx</em>&nbsp;</td><td>DHM context </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>p</em>&nbsp;</td><td>&amp;(start of input buffer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>end</em>&nbsp;</td><td>end of buffer</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 if successful, or an XYSSL_ERR_DHM_XXX error code </dd></dl>

</div>
</div><p>
<a class="anchor" name="8471f39aeeef841a4984f844debb2186"></a><!-- doxytag: member="dhm.h::dhm_read_public" ref="8471f39aeeef841a4984f844debb2186" args="(dhm_context *ctx, unsigned char *input, int ilen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dhm_read_public           </td>
          <td>(</td>
          <td class="paramtype">dhm_context *&nbsp;</td>
          <td class="paramname"> <em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ilen</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Import the peer's public value G^Y. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ctx</em>&nbsp;</td><td>DHM context </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>input</em>&nbsp;</td><td>input buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ilen</em>&nbsp;</td><td>size of buffer</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 if successful, or an XYSSL_ERR_DHM_XXX error code </dd></dl>

</div>
</div><p>
<a class="anchor" name="61cc4f6b8b132f50e34b6f42b74d08fa"></a><!-- doxytag: member="dhm.h::dhm_self_test" ref="61cc4f6b8b132f50e34b6f42b74d08fa" args="(int verbose)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dhm_self_test           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>verbose</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Checkup routine. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 if successful, or 1 if the test failed </dd></dl>

</div>
</div><p>
<hr size="1"><address style="text-align: right;"><small>Generated on Sat Oct 20 19:09:38 2007 for xyssl by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.3 </small></address>
</body>
</html>
