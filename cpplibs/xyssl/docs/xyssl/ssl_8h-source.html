<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>XySSL: include/xyssl/ssl.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>include/xyssl/ssl.h</h1><a href="ssl_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00004"></a>00004 <span class="preprocessor">#ifndef XYSSL_SSL_H</span>
<a name="l00005"></a>00005 <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_SSL_H</span>
<a name="l00006"></a>00006 <span class="preprocessor"></span>
<a name="l00007"></a>00007 <span class="preprocessor">#include &lt;time.h&gt;</span>
<a name="l00008"></a>00008 
<a name="l00009"></a>00009 <span class="preprocessor">#include "<a class="code" href="net_8h.html">xyssl/net.h</a>"</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include "<a class="code" href="dhm_8h.html">xyssl/dhm.h</a>"</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include "<a class="code" href="rsa_8h.html">xyssl/rsa.h</a>"</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include "<a class="code" href="md5_8h.html">xyssl/md5.h</a>"</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include "<a class="code" href="sha1_8h.html">xyssl/sha1.h</a>"</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include "<a class="code" href="x509_8h.html">xyssl/x509.h</a>"</span>
<a name="l00015"></a>00015 
<a name="l00016"></a><a class="code" href="ssl_8h.html#2cf8e42e3f909c4d26efb8df7ceeb1f1">00016</a> <span class="preprocessor">#define XYSSL_ERR_SSL_FEATURE_UNAVAILABLE               -0x1000</span>
<a name="l00017"></a><a class="code" href="ssl_8h.html#c510afbcdd52aadf213d1ab3a6c04de8">00017</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_SSL_BAD_INPUT_DATA                    -0x1800</span>
<a name="l00018"></a><a class="code" href="ssl_8h.html#750424370a0c937da4e33d56f5eb5d28">00018</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_SSL_INVALID_MAC                       -0x2000</span>
<a name="l00019"></a><a class="code" href="ssl_8h.html#89e5fb27c10dfe7fd05bf73c142333be">00019</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_SSL_INVALID_RECORD                    -0x2800</span>
<a name="l00020"></a><a class="code" href="ssl_8h.html#75a099d8c3bf339e609bc13838136bd9">00020</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_SSL_INVALID_MODULUS_SIZE              -0x3000</span>
<a name="l00021"></a><a class="code" href="ssl_8h.html#2ae612e34e39d4d0b9cd4f2d9528973c">00021</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_SSL_UNKNOWN_CIPHER                    -0x3800</span>
<a name="l00022"></a><a class="code" href="ssl_8h.html#a2543abdd274161fbed59d7e1445428f">00022</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_SSL_NO_CIPHER_CHOSEN                  -0x4000</span>
<a name="l00023"></a><a class="code" href="ssl_8h.html#861138f79ed791c65cd421a256c856e5">00023</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_SSL_NO_SESSION_FOUND                  -0x4800</span>
<a name="l00024"></a><a class="code" href="ssl_8h.html#744f95734447856db13042bf8b73d0cd">00024</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_SSL_NO_CLIENT_CERTIFICATE             -0x5000</span>
<a name="l00025"></a><a class="code" href="ssl_8h.html#43998474c70c756f1147ecd8274f4641">00025</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_SSL_CERTIFICATE_TOO_LARGE             -0x5800</span>
<a name="l00026"></a><a class="code" href="ssl_8h.html#3ce55e7dad35aa188705c1e8f1df3ee4">00026</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_SSL_CERTIFICATE_REQUIRED              -0x6000</span>
<a name="l00027"></a><a class="code" href="ssl_8h.html#adb1cd3de3b9c66e6afedea03049dfae">00027</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_SSL_PRIVATE_KEY_REQUIRED              -0x6800</span>
<a name="l00028"></a><a class="code" href="ssl_8h.html#e205254ae73f89050b676b35fc3e82c1">00028</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_SSL_CA_CHAIN_REQUIRED                 -0x7000</span>
<a name="l00029"></a><a class="code" href="ssl_8h.html#6636f9583526d2bec3eb018c36eeab01">00029</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_SSL_UNEXPECTED_MESSAGE                -0x7800</span>
<a name="l00030"></a><a class="code" href="ssl_8h.html#4f523150b5bfb8ca7cf4a812138eadc0">00030</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_SSL_FATAL_ALERT_MESSAGE               -0x8000</span>
<a name="l00031"></a><a class="code" href="ssl_8h.html#5cb5f6e051d49d01f1f178ce01dd6d0e">00031</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_SSL_PEER_VERIFY_FAILED                -0x8800</span>
<a name="l00032"></a><a class="code" href="ssl_8h.html#312e2e81d84dce87cc8916e544c463d6">00032</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_SSL_PEER_CLOSE_NOTIFY                 -0x9000</span>
<a name="l00033"></a><a class="code" href="ssl_8h.html#b860ba28d5ac0084ca4ca86957647432">00033</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_SSL_BAD_HS_CLIENT_HELLO               -0x9800</span>
<a name="l00034"></a><a class="code" href="ssl_8h.html#d3d9d5927d8929aee66a2e49049d8fc7">00034</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_SSL_BAD_HS_SERVER_HELLO               -0xA000</span>
<a name="l00035"></a><a class="code" href="ssl_8h.html#1bfce157436e19f3489542052283eaf7">00035</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_SSL_BAD_HS_CERTIFICATE                -0xA800</span>
<a name="l00036"></a><a class="code" href="ssl_8h.html#d6c361960728c77e7c60de28b617929b">00036</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_SSL_BAD_HS_CERTIFICATE_REQUEST        -0xB000</span>
<a name="l00037"></a><a class="code" href="ssl_8h.html#5cf816081bf4e61aa129ff66d8e50203">00037</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_SSL_BAD_HS_SERVER_KEY_EXCHANGE        -0xB800</span>
<a name="l00038"></a><a class="code" href="ssl_8h.html#13a274897c1a5c5b4afe62fcbdfe51c6">00038</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_SSL_BAD_HS_SERVER_HELLO_DONE          -0xC000</span>
<a name="l00039"></a><a class="code" href="ssl_8h.html#b47a7f8e05b42773eccb6e0ba1ed5896">00039</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_SSL_BAD_HS_CLIENT_KEY_EXCHANGE        -0xC800</span>
<a name="l00040"></a><a class="code" href="ssl_8h.html#c91f854445c8a085e512a63a5ddb3f5d">00040</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_SSL_BAD_HS_CERTIFICATE_VERIFY         -0xD000</span>
<a name="l00041"></a><a class="code" href="ssl_8h.html#fdccac705e10f49b3b30295a2efa0c84">00041</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_SSL_BAD_HS_CHANGE_CIPHER_SPEC         -0xD800</span>
<a name="l00042"></a><a class="code" href="ssl_8h.html#f99b339b36b67d43609947d03e52de80">00042</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_SSL_BAD_HS_FINISHED                   -0xE000</span>
<a name="l00043"></a>00043 <span class="preprocessor"></span>
<a name="l00044"></a>00044 <span class="comment">/*</span>
<a name="l00045"></a>00045 <span class="comment"> * Various constants</span>
<a name="l00046"></a>00046 <span class="comment"> */</span>
<a name="l00047"></a><a class="code" href="ssl_8h.html#84391a43fea28830ad138e2418a9728b">00047</a> <span class="preprocessor">#define SSL_MAJOR_VERSION_3             3</span>
<a name="l00048"></a><a class="code" href="ssl_8h.html#4fedd81485a2c0a99b8d0d1dea245302">00048</a> <span class="preprocessor"></span><span class="preprocessor">#define SSL_MINOR_VERSION_0             0   </span>
<a name="l00049"></a><a class="code" href="ssl_8h.html#3e0c978697874bb5457d61f7515e8f55">00049</a> <span class="preprocessor">#define SSL_MINOR_VERSION_1             1   </span>
<a name="l00050"></a><a class="code" href="ssl_8h.html#ab565447d7abe2dcb01544e7dbfcd4c9">00050</a> <span class="preprocessor">#define SSL_MINOR_VERSION_2             2   </span>
<a name="l00052"></a><a class="code" href="ssl_8h.html#7d3c4f57b35a1b8c395ebd7451e2211b">00052</a> <span class="preprocessor">#define SSL_IS_CLIENT                   0</span>
<a name="l00053"></a><a class="code" href="ssl_8h.html#8fe8b6c95281a7048839f8b30713ff35">00053</a> <span class="preprocessor"></span><span class="preprocessor">#define SSL_IS_SERVER                   1</span>
<a name="l00054"></a><a class="code" href="ssl_8h.html#d47aca4f7ebf39713fa96eac86343e7b">00054</a> <span class="preprocessor"></span><span class="preprocessor">#define SSL_COMPRESS_NULL               0</span>
<a name="l00055"></a>00055 <span class="preprocessor"></span>
<a name="l00056"></a><a class="code" href="ssl_8h.html#060b51dc564d4b9dc941e81eab66d60c">00056</a> <span class="preprocessor">#define SSL_VERIFY_NONE                 0</span>
<a name="l00057"></a><a class="code" href="ssl_8h.html#7760ecdb03ee6f4520a21c04942c0883">00057</a> <span class="preprocessor"></span><span class="preprocessor">#define SSL_VERIFY_OPTIONAL             1</span>
<a name="l00058"></a><a class="code" href="ssl_8h.html#1f9549da00fa29209b3db3c5f11a329b">00058</a> <span class="preprocessor"></span><span class="preprocessor">#define SSL_VERIFY_REQUIRED             2</span>
<a name="l00059"></a>00059 <span class="preprocessor"></span>
<a name="l00060"></a><a class="code" href="ssl_8h.html#70bafb07a819e6bf9df2c97ce6dd139d">00060</a> <span class="preprocessor">#define SSL_MAX_CONTENT_LEN         16384</span>
<a name="l00061"></a>00061 <span class="preprocessor"></span>
<a name="l00062"></a>00062 <span class="comment">/*</span>
<a name="l00063"></a>00063 <span class="comment"> * Allow an extra 512 bytes for the record header</span>
<a name="l00064"></a>00064 <span class="comment"> * and encryption overhead (counter + MAC + padding).</span>
<a name="l00065"></a>00065 <span class="comment"> */</span>
<a name="l00066"></a><a class="code" href="ssl_8h.html#70dcd2bbca08cfb787f98019dc98bad5">00066</a> <span class="preprocessor">#define SSL_BUFFER_LEN (SSL_MAX_CONTENT_LEN + 512)</span>
<a name="l00067"></a>00067 <span class="preprocessor"></span>
<a name="l00068"></a>00068 <span class="comment">/*</span>
<a name="l00069"></a>00069 <span class="comment"> * Supported ciphersuites</span>
<a name="l00070"></a>00070 <span class="comment"> */</span>
<a name="l00071"></a><a class="code" href="ssl_8h.html#34f57a075af5f38f7db5607035f84b86">00071</a> <span class="preprocessor">#define SSL_RSA_RC4_128_MD5              4</span>
<a name="l00072"></a><a class="code" href="ssl_8h.html#6e454fd13d0cc6830f8f09520e1878c8">00072</a> <span class="preprocessor"></span><span class="preprocessor">#define SSL_RSA_RC4_128_SHA              5</span>
<a name="l00073"></a><a class="code" href="ssl_8h.html#12561504b916289724d9d257b164a4e8">00073</a> <span class="preprocessor"></span><span class="preprocessor">#define SSL_RSA_DES_168_SHA             10</span>
<a name="l00074"></a><a class="code" href="ssl_8h.html#d1d3a8b4c2777f12f561870743a4346f">00074</a> <span class="preprocessor"></span><span class="preprocessor">#define SSL_EDH_RSA_DES_168_SHA         22</span>
<a name="l00075"></a><a class="code" href="ssl_8h.html#bc9c086c8fa1996d6c1f4ecd4a941324">00075</a> <span class="preprocessor"></span><span class="preprocessor">#define SSL_RSA_AES_128_SHA             47</span>
<a name="l00076"></a><a class="code" href="ssl_8h.html#1aa95ad620245e884e86ff7f081326c1">00076</a> <span class="preprocessor"></span><span class="preprocessor">#define SSL_RSA_AES_256_SHA             53</span>
<a name="l00077"></a><a class="code" href="ssl_8h.html#332f252c32573c8bf6ae216393863566">00077</a> <span class="preprocessor"></span><span class="preprocessor">#define SSL_EDH_RSA_AES_256_SHA         57</span>
<a name="l00078"></a>00078 <span class="preprocessor"></span>
<a name="l00079"></a>00079 <span class="comment">/*</span>
<a name="l00080"></a>00080 <span class="comment"> * Message, alert and handshake types</span>
<a name="l00081"></a>00081 <span class="comment"> */</span>
<a name="l00082"></a><a class="code" href="ssl_8h.html#738eccdfea2b6a0de26231a0c2aafe4f">00082</a> <span class="preprocessor">#define SSL_MSG_CHANGE_CIPHER_SPEC     20</span>
<a name="l00083"></a><a class="code" href="ssl_8h.html#3d6dc94916f324f0a42881bd6e6f7db6">00083</a> <span class="preprocessor"></span><span class="preprocessor">#define SSL_MSG_ALERT                  21</span>
<a name="l00084"></a><a class="code" href="ssl_8h.html#dd1f218869a9aeb6f8b1190a99f0625a">00084</a> <span class="preprocessor"></span><span class="preprocessor">#define SSL_MSG_HANDSHAKE              22</span>
<a name="l00085"></a><a class="code" href="ssl_8h.html#6ea7789fe625447a1bf69d9a2382c861">00085</a> <span class="preprocessor"></span><span class="preprocessor">#define SSL_MSG_APPLICATION_DATA       23</span>
<a name="l00086"></a>00086 <span class="preprocessor"></span>
<a name="l00087"></a><a class="code" href="ssl_8h.html#bbf4062784969ad1b43d6c4d72cfbecf">00087</a> <span class="preprocessor">#define SSL_ALERT_CLOSE_NOTIFY          0</span>
<a name="l00088"></a><a class="code" href="ssl_8h.html#2ae352c6adc73f59cf6f6d1e6bd2749c">00088</a> <span class="preprocessor"></span><span class="preprocessor">#define SSL_ALERT_WARNING               1</span>
<a name="l00089"></a><a class="code" href="ssl_8h.html#69c2a72bb5f15873217a05cd4e593fb8">00089</a> <span class="preprocessor"></span><span class="preprocessor">#define SSL_ALERT_FATAL                 2</span>
<a name="l00090"></a><a class="code" href="ssl_8h.html#74463751bfd86dba24f1a2f0b796327e">00090</a> <span class="preprocessor"></span><span class="preprocessor">#define SSL_ALERT_NO_CERTIFICATE       41</span>
<a name="l00091"></a>00091 <span class="preprocessor"></span>
<a name="l00092"></a><a class="code" href="ssl_8h.html#fda93251f735deb8569698986df4bb95">00092</a> <span class="preprocessor">#define SSL_HS_HELLO_REQUEST            0</span>
<a name="l00093"></a><a class="code" href="ssl_8h.html#565597ab4583db29a05d49c7fa0686a2">00093</a> <span class="preprocessor"></span><span class="preprocessor">#define SSL_HS_CLIENT_HELLO             1</span>
<a name="l00094"></a><a class="code" href="ssl_8h.html#ad10d88b523225e34a788bb2553d2593">00094</a> <span class="preprocessor"></span><span class="preprocessor">#define SSL_HS_SERVER_HELLO             2</span>
<a name="l00095"></a><a class="code" href="ssl_8h.html#aaaa25b3ce92c5da9f357928032c3614">00095</a> <span class="preprocessor"></span><span class="preprocessor">#define SSL_HS_CERTIFICATE             11</span>
<a name="l00096"></a><a class="code" href="ssl_8h.html#b9903e824d585f667a0018fa459dc30a">00096</a> <span class="preprocessor"></span><span class="preprocessor">#define SSL_HS_SERVER_KEY_EXCHANGE     12</span>
<a name="l00097"></a><a class="code" href="ssl_8h.html#146ced9f8b0ae516cc78f1cec065b4a2">00097</a> <span class="preprocessor"></span><span class="preprocessor">#define SSL_HS_CERTIFICATE_REQUEST     13</span>
<a name="l00098"></a><a class="code" href="ssl_8h.html#56bb1fe1c001cd5905e26a7ad6cee303">00098</a> <span class="preprocessor"></span><span class="preprocessor">#define SSL_HS_SERVER_HELLO_DONE       14</span>
<a name="l00099"></a><a class="code" href="ssl_8h.html#373b6769a2f5555bc03d16f25fd43286">00099</a> <span class="preprocessor"></span><span class="preprocessor">#define SSL_HS_CERTIFICATE_VERIFY      15</span>
<a name="l00100"></a><a class="code" href="ssl_8h.html#3f20623ea264473b438e96339278c16b">00100</a> <span class="preprocessor"></span><span class="preprocessor">#define SSL_HS_CLIENT_KEY_EXCHANGE     16</span>
<a name="l00101"></a><a class="code" href="ssl_8h.html#47bcc86840fcbc68b5a70bfca774258a">00101</a> <span class="preprocessor"></span><span class="preprocessor">#define SSL_HS_FINISHED                20</span>
<a name="l00102"></a>00102 <span class="preprocessor"></span>
<a name="l00103"></a>00103 <span class="comment">/*</span>
<a name="l00104"></a>00104 <span class="comment"> * TLS extensions</span>
<a name="l00105"></a>00105 <span class="comment"> */</span>
<a name="l00106"></a><a class="code" href="ssl_8h.html#21bb5a4f093a191a4e3f0efae924dd7c">00106</a> <span class="preprocessor">#define TLS_EXT_SERVERNAME              0</span>
<a name="l00107"></a><a class="code" href="ssl_8h.html#948d249c0b07844056fdf68c640bb2ca">00107</a> <span class="preprocessor"></span><span class="preprocessor">#define TLS_EXT_SERVERNAME_HOSTNAME     0</span>
<a name="l00108"></a>00108 <span class="preprocessor"></span>
<a name="l00109"></a>00109 <span class="comment">/*</span>
<a name="l00110"></a>00110 <span class="comment"> * SSL state machine</span>
<a name="l00111"></a>00111 <span class="comment"> */</span>
<a name="l00112"></a><a class="code" href="ssl_8h.html#2c5a6a88b079c75237bd38369303f562">00112</a> <span class="keyword">typedef</span> <span class="keyword">enum</span>
<a name="l00113"></a>00113 {
<a name="l00114"></a>00114     <a class="code" href="ssl_8h.html#2c5a6a88b079c75237bd38369303f562a484774faa269995acabd2a76e56aaf0">SSL_HELLO_REQUEST</a>,
<a name="l00115"></a>00115     <a class="code" href="ssl_8h.html#2c5a6a88b079c75237bd38369303f562a6f3b90371b211cf68edb9e1b1aa4608">SSL_CLIENT_HELLO</a>,
<a name="l00116"></a>00116     <a class="code" href="ssl_8h.html#2c5a6a88b079c75237bd38369303f562f97b0ce4208c0279bd9a2d70a4ebf39e">SSL_SERVER_HELLO</a>,
<a name="l00117"></a>00117     <a class="code" href="ssl_8h.html#2c5a6a88b079c75237bd38369303f562580e2989d137d0d2fee273bf1c88b2c9">SSL_SERVER_CERTIFICATE</a>,
<a name="l00118"></a>00118     <a class="code" href="ssl_8h.html#2c5a6a88b079c75237bd38369303f5626f0b74cee5ae2dc762ad1295cf4b9516">SSL_SERVER_KEY_EXCHANGE</a>,
<a name="l00119"></a>00119     <a class="code" href="ssl_8h.html#2c5a6a88b079c75237bd38369303f562567600233b71938cea7108ad31020a03">SSL_CERTIFICATE_REQUEST</a>,
<a name="l00120"></a>00120     <a class="code" href="ssl_8h.html#2c5a6a88b079c75237bd38369303f562a65ecefdcc848d5fbce65009c67d1968">SSL_SERVER_HELLO_DONE</a>,
<a name="l00121"></a>00121     <a class="code" href="ssl_8h.html#2c5a6a88b079c75237bd38369303f56285e000890081f50047f3783a933c821b">SSL_CLIENT_CERTIFICATE</a>,
<a name="l00122"></a>00122     <a class="code" href="ssl_8h.html#2c5a6a88b079c75237bd38369303f562e2099b4016268a6bc24336c12a739fa4">SSL_CLIENT_KEY_EXCHANGE</a>,
<a name="l00123"></a>00123     <a class="code" href="ssl_8h.html#2c5a6a88b079c75237bd38369303f562370acc709df36935088aac79e6684d75">SSL_CERTIFICATE_VERIFY</a>,
<a name="l00124"></a>00124     <a class="code" href="ssl_8h.html#2c5a6a88b079c75237bd38369303f562ad3f70e8a51b6b60b1b1433536a4c455">SSL_CLIENT_CHANGE_CIPHER_SPEC</a>,
<a name="l00125"></a>00125     <a class="code" href="ssl_8h.html#2c5a6a88b079c75237bd38369303f5622d9901871f9719d9c83ab596654a1659">SSL_CLIENT_FINISHED</a>,
<a name="l00126"></a>00126     <a class="code" href="ssl_8h.html#2c5a6a88b079c75237bd38369303f5626df82339c69b544e97bcb543df990664">SSL_SERVER_CHANGE_CIPHER_SPEC</a>,
<a name="l00127"></a>00127     <a class="code" href="ssl_8h.html#2c5a6a88b079c75237bd38369303f5629c73bd4ec6c943c93ef00a4bfc655637">SSL_SERVER_FINISHED</a>,
<a name="l00128"></a>00128     <a class="code" href="ssl_8h.html#2c5a6a88b079c75237bd38369303f562e2821731d7435adec855c36aa99ee41c">SSL_FLUSH_BUFFERS</a>,
<a name="l00129"></a>00129     <a class="code" href="ssl_8h.html#2c5a6a88b079c75237bd38369303f5625b33e824af78e48ea33553e3d712e036">SSL_HANDSHAKE_OVER</a>
<a name="l00130"></a>00130 }
<a name="l00131"></a>00131 <a class="code" href="ssl_8h.html#2c5a6a88b079c75237bd38369303f562">ssl_states</a>;
<a name="l00132"></a>00132 
<a name="l00133"></a><a class="code" href="ssl_8h.html#bb59b301c07806142c790115fa49eb9e">00133</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__ssl__session.html">_ssl_session</a> <a class="code" href="ssl_8h.html#bb59b301c07806142c790115fa49eb9e">ssl_session</a>;
<a name="l00134"></a><a class="code" href="ssl_8h.html#6cc90742039ba6f9fa184c22af7ea151">00134</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__ssl__context.html">_ssl_context</a> <a class="code" href="ssl_8h.html#6cc90742039ba6f9fa184c22af7ea151">ssl_context</a>;
<a name="l00135"></a>00135 
<a name="l00136"></a>00136 <span class="comment">/*</span>
<a name="l00137"></a>00137 <span class="comment"> * This structure is used for session resuming.</span>
<a name="l00138"></a>00138 <span class="comment"> */</span>
<a name="l00139"></a><a class="code" href="struct__ssl__session.html">00139</a> <span class="keyword">struct </span><a class="code" href="struct__ssl__session.html">_ssl_session</a>
<a name="l00140"></a>00140 {
<a name="l00141"></a><a class="code" href="struct__ssl__session.html#f68d1f9b5941ff5cca18b5e97d52299d">00141</a>     time_t <a class="code" href="struct__ssl__session.html#f68d1f9b5941ff5cca18b5e97d52299d">start</a>;               
<a name="l00142"></a><a class="code" href="struct__ssl__session.html#6ef3d13933df9d5ca13479d6c9fb3e7e">00142</a>     <span class="keywordtype">int</span> <a class="code" href="struct__ssl__session.html#6ef3d13933df9d5ca13479d6c9fb3e7e">cipher</a>;                 
<a name="l00143"></a><a class="code" href="struct__ssl__session.html#785f18a6bcb15d084ed6f1a4f1263579">00143</a>     <span class="keywordtype">int</span> <a class="code" href="struct__ssl__session.html#785f18a6bcb15d084ed6f1a4f1263579">length</a>;                 
<a name="l00144"></a><a class="code" href="struct__ssl__session.html#247ca3921617cd58ea115d0c084429db">00144</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <span class="keywordtype">id</span>[32];       
<a name="l00145"></a><a class="code" href="struct__ssl__session.html#697ab473d946a7ca1bb8a5be54d9fafa">00145</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="struct__ssl__session.html#697ab473d946a7ca1bb8a5be54d9fafa">master</a>[48];   
<a name="l00146"></a><a class="code" href="struct__ssl__session.html#6ab26ae36ab56271338bcdc1bb870670">00146</a>     <a class="code" href="ssl_8h.html#bb59b301c07806142c790115fa49eb9e">ssl_session</a> *<a class="code" href="struct__ssl__session.html#6ab26ae36ab56271338bcdc1bb870670">next</a>;          
<a name="l00147"></a>00147 };
<a name="l00148"></a>00148 
<a name="l00149"></a><a class="code" href="struct__ssl__context.html">00149</a> <span class="keyword">struct </span><a class="code" href="struct__ssl__context.html">_ssl_context</a>
<a name="l00150"></a>00150 {
<a name="l00151"></a>00151     <span class="comment">/*</span>
<a name="l00152"></a>00152 <span class="comment">     * Miscellaneous</span>
<a name="l00153"></a>00153 <span class="comment">     */</span>
<a name="l00154"></a><a class="code" href="struct__ssl__context.html#5bf877cd6d310fcd317772e4a74ea4b1">00154</a>     <span class="keywordtype">int</span> <a class="code" href="struct__ssl__context.html#5bf877cd6d310fcd317772e4a74ea4b1">state</a>;                  
<a name="l00156"></a><a class="code" href="struct__ssl__context.html#7ba00e9f3f41c954438ef450f61a1127">00156</a>     <span class="keywordtype">int</span> <a class="code" href="struct__ssl__context.html#7ba00e9f3f41c954438ef450f61a1127">major_ver</a>;              
<a name="l00157"></a><a class="code" href="struct__ssl__context.html#13bc8af6fca4121fed003649e8e72074">00157</a>     <span class="keywordtype">int</span> <a class="code" href="struct__ssl__context.html#13bc8af6fca4121fed003649e8e72074">minor_ver</a>;              
<a name="l00159"></a><a class="code" href="struct__ssl__context.html#a53d1c4449b3e3aaf4dc3f8eb4ec3b97">00159</a>     <span class="keywordtype">int</span> <a class="code" href="struct__ssl__context.html#a53d1c4449b3e3aaf4dc3f8eb4ec3b97">max_major_ver</a>;          
<a name="l00160"></a><a class="code" href="struct__ssl__context.html#dfc9bfdd067fe5caf68b334accd8cd43">00160</a>     <span class="keywordtype">int</span> <a class="code" href="struct__ssl__context.html#dfc9bfdd067fe5caf68b334accd8cd43">max_minor_ver</a>;          
<a name="l00162"></a>00162     <span class="comment">/*</span>
<a name="l00163"></a>00163 <span class="comment">     * Callbacks (RNG, debug, I/O)</span>
<a name="l00164"></a>00164 <span class="comment">     */</span>
<a name="l00165"></a>00165     int  (*<a class="code" href="struct__ssl__context.html#3087101c5468f154422ff8d0b1b9f09f">f_rng</a>)(<span class="keywordtype">void</span> *);
<a name="l00166"></a>00166     void (*<a class="code" href="struct__ssl__context.html#d6b0b6fa8df5955b74814fe9cd39db1f">f_dbg</a>)(<span class="keywordtype">void</span> *, int, <span class="keywordtype">char</span> *);
<a name="l00167"></a>00167     int (*<a class="code" href="struct__ssl__context.html#26209518317beb876094e4abd8ba2f0f">f_recv</a>)(<span class="keywordtype">void</span> *, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *, int);
<a name="l00168"></a>00168     int (*<a class="code" href="struct__ssl__context.html#6799f3ab677e02471f7bfdcd359d4dc8">f_send</a>)(<span class="keywordtype">void</span> *, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *, int);
<a name="l00169"></a>00169 
<a name="l00170"></a><a class="code" href="struct__ssl__context.html#25fedaa600ea4c99444528fdf5bb0bdc">00170</a>     <span class="keywordtype">void</span> *<a class="code" href="struct__ssl__context.html#25fedaa600ea4c99444528fdf5bb0bdc">p_rng</a>;                
<a name="l00171"></a><a class="code" href="struct__ssl__context.html#c176b1daaaae7e2009b4467cd498a18b">00171</a>     <span class="keywordtype">void</span> *<a class="code" href="struct__ssl__context.html#c176b1daaaae7e2009b4467cd498a18b">p_dbg</a>;                
<a name="l00172"></a><a class="code" href="struct__ssl__context.html#ab966bee783ec3d1e0aa3113bdbdedbc">00172</a>     <span class="keywordtype">void</span> *<a class="code" href="struct__ssl__context.html#ab966bee783ec3d1e0aa3113bdbdedbc">p_recv</a>;               
<a name="l00173"></a><a class="code" href="struct__ssl__context.html#fb3631c56c80c93fd6a10ae6c5f31eff">00173</a>     <span class="keywordtype">void</span> *<a class="code" href="struct__ssl__context.html#fb3631c56c80c93fd6a10ae6c5f31eff">p_send</a>;               
<a name="l00175"></a>00175     <span class="comment">/*</span>
<a name="l00176"></a>00176 <span class="comment">     * Session layer</span>
<a name="l00177"></a>00177 <span class="comment">     */</span>
<a name="l00178"></a><a class="code" href="struct__ssl__context.html#3417783ab76ac99af684696d560ce20a">00178</a>     <span class="keywordtype">int</span> <a class="code" href="struct__ssl__context.html#3417783ab76ac99af684696d560ce20a">resume</a>;                         
<a name="l00179"></a><a class="code" href="struct__ssl__context.html#437ecf8f6767b3284a7aa7588910b7c0">00179</a>     <span class="keywordtype">int</span> <a class="code" href="struct__ssl__context.html#437ecf8f6767b3284a7aa7588910b7c0">timeout</a>;                        
<a name="l00180"></a><a class="code" href="struct__ssl__context.html#e6956b0a88d392757b01fcdfa3fd45e0">00180</a>     <a class="code" href="ssl_8h.html#bb59b301c07806142c790115fa49eb9e">ssl_session</a> *<a class="code" href="struct__ssl__context.html#e6956b0a88d392757b01fcdfa3fd45e0">session</a>;               
<a name="l00181"></a>00181     int (*<a class="code" href="struct__ssl__context.html#163ebf6fad51145608a64a4d87b4889e">s_get</a>)(<a class="code" href="ssl_8h.html#6cc90742039ba6f9fa184c22af7ea151">ssl_context</a> *);        
<a name="l00182"></a>00182     int (*<a class="code" href="struct__ssl__context.html#713e4a8b03516f730ac4da1e35154436">s_set</a>)(<a class="code" href="ssl_8h.html#6cc90742039ba6f9fa184c22af7ea151">ssl_context</a> *);        
<a name="l00184"></a>00184     <span class="comment">/*</span>
<a name="l00185"></a>00185 <span class="comment">     * Record layer (incoming data)</span>
<a name="l00186"></a>00186 <span class="comment">     */</span>
<a name="l00187"></a><a class="code" href="struct__ssl__context.html#1ae07eb9a0ad8d605c11ad8ea9436b4e">00187</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="struct__ssl__context.html#1ae07eb9a0ad8d605c11ad8ea9436b4e">in_ctr</a>;      
<a name="l00188"></a><a class="code" href="struct__ssl__context.html#07ea9d3221321212616c77288bf45012">00188</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="struct__ssl__context.html#07ea9d3221321212616c77288bf45012">in_hdr</a>;      
<a name="l00189"></a><a class="code" href="struct__ssl__context.html#eb559e00ac2523e841e70a24c672a1c7">00189</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="struct__ssl__context.html#eb559e00ac2523e841e70a24c672a1c7">in_msg</a>;      
<a name="l00190"></a><a class="code" href="struct__ssl__context.html#f32350f1de7f91785250f6ac45afd3d5">00190</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="struct__ssl__context.html#f32350f1de7f91785250f6ac45afd3d5">in_offt</a>;     
<a name="l00192"></a><a class="code" href="struct__ssl__context.html#be70b82e9b8119ce20889e21451d87a5">00192</a>     <span class="keywordtype">int</span> <a class="code" href="struct__ssl__context.html#be70b82e9b8119ce20889e21451d87a5">in_msgtype</a>;             
<a name="l00193"></a><a class="code" href="struct__ssl__context.html#8f4f58a98cc64824a74dc21f0f9cb24d">00193</a>     <span class="keywordtype">int</span> <a class="code" href="struct__ssl__context.html#8f4f58a98cc64824a74dc21f0f9cb24d">in_msglen</a>;              
<a name="l00194"></a><a class="code" href="struct__ssl__context.html#036b1b6203308a974da2bb8ada9a9a32">00194</a>     <span class="keywordtype">int</span> <a class="code" href="struct__ssl__context.html#036b1b6203308a974da2bb8ada9a9a32">in_left</a>;                
<a name="l00196"></a><a class="code" href="struct__ssl__context.html#0e5facf1c099ff15d50c92538a6b8e50">00196</a>     <span class="keywordtype">int</span> <a class="code" href="struct__ssl__context.html#0e5facf1c099ff15d50c92538a6b8e50">in_hslen</a>;               
<a name="l00197"></a><a class="code" href="struct__ssl__context.html#0c2e5417a064dd13a7c4bc28035e2c67">00197</a>     <span class="keywordtype">int</span> <a class="code" href="struct__ssl__context.html#0c2e5417a064dd13a7c4bc28035e2c67">nb_zero</a>;                
<a name="l00199"></a>00199     <span class="comment">/*</span>
<a name="l00200"></a>00200 <span class="comment">     * Record layer (outgoing data)</span>
<a name="l00201"></a>00201 <span class="comment">     */</span>
<a name="l00202"></a><a class="code" href="struct__ssl__context.html#5d6dea03e21a3305cb274a4e19b02a75">00202</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="struct__ssl__context.html#5d6dea03e21a3305cb274a4e19b02a75">out_ctr</a>;     
<a name="l00203"></a><a class="code" href="struct__ssl__context.html#4459b04a18827ee9daa1a70450d5281f">00203</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="struct__ssl__context.html#4459b04a18827ee9daa1a70450d5281f">out_hdr</a>;     
<a name="l00204"></a><a class="code" href="struct__ssl__context.html#611a2e13418ea5b23ccd8f297280a7bc">00204</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="struct__ssl__context.html#611a2e13418ea5b23ccd8f297280a7bc">out_msg</a>;     
<a name="l00206"></a><a class="code" href="struct__ssl__context.html#d6199b754f91d142c08f1fe7fb690145">00206</a>     <span class="keywordtype">int</span> <a class="code" href="struct__ssl__context.html#d6199b754f91d142c08f1fe7fb690145">out_msgtype</a>;            
<a name="l00207"></a><a class="code" href="struct__ssl__context.html#c185b103766080dc4d75f05ffe8d9c63">00207</a>     <span class="keywordtype">int</span> <a class="code" href="struct__ssl__context.html#c185b103766080dc4d75f05ffe8d9c63">out_msglen</a>;             
<a name="l00208"></a><a class="code" href="struct__ssl__context.html#d7fa6c986914c8686e3380b350959a72">00208</a>     <span class="keywordtype">int</span> <a class="code" href="struct__ssl__context.html#d7fa6c986914c8686e3380b350959a72">out_left</a>;               
<a name="l00210"></a>00210     <span class="comment">/*</span>
<a name="l00211"></a>00211 <span class="comment">     * PKI layer</span>
<a name="l00212"></a>00212 <span class="comment">     */</span>
<a name="l00213"></a><a class="code" href="struct__ssl__context.html#7d1fdeb8d0c99fb706719824510078ec">00213</a>     <a class="code" href="structrsa__context.html">rsa_context</a> *<a class="code" href="struct__ssl__context.html#7d1fdeb8d0c99fb706719824510078ec">rsa_key</a>;               
<a name="l00214"></a><a class="code" href="struct__ssl__context.html#936f92c30b65c1dcf91e13a62c1e07ec">00214</a>     <a class="code" href="struct__x509__cert.html">x509_cert</a> *<a class="code" href="struct__ssl__context.html#936f92c30b65c1dcf91e13a62c1e07ec">own_cert</a>;                
<a name="l00215"></a><a class="code" href="struct__ssl__context.html#9f9519a82095f743661a3cd10e6cfc20">00215</a>     <a class="code" href="struct__x509__cert.html">x509_cert</a> *<a class="code" href="struct__ssl__context.html#9f9519a82095f743661a3cd10e6cfc20">ca_chain</a>;                
<a name="l00216"></a><a class="code" href="struct__ssl__context.html#382d037c970900b022bff5785ef74f7d">00216</a>     <a class="code" href="struct__x509__cert.html">x509_cert</a> *<a class="code" href="struct__ssl__context.html#382d037c970900b022bff5785ef74f7d">peer_cert</a>;               
<a name="l00217"></a><a class="code" href="struct__ssl__context.html#a1aa01d2b96039bc53089038c30ee058">00217</a>     <span class="keywordtype">char</span> *<a class="code" href="struct__ssl__context.html#a1aa01d2b96039bc53089038c30ee058">peer_cn</a>;                      
<a name="l00219"></a><a class="code" href="struct__ssl__context.html#32b691e813fdf33c5399a7e91db6f23a">00219</a>     <span class="keywordtype">int</span> <a class="code" href="struct__ssl__context.html#32b691e813fdf33c5399a7e91db6f23a">endpoint</a>;                       
<a name="l00220"></a><a class="code" href="struct__ssl__context.html#589640abace5f4e690bead3c18092bd5">00220</a>     <span class="keywordtype">int</span> <a class="code" href="struct__ssl__context.html#589640abace5f4e690bead3c18092bd5">authmode</a>;                       
<a name="l00221"></a><a class="code" href="struct__ssl__context.html#e5187c34948f80111bb9bd7e603cca2d">00221</a>     <span class="keywordtype">int</span> <a class="code" href="struct__ssl__context.html#e5187c34948f80111bb9bd7e603cca2d">client_auth</a>;                    
<a name="l00222"></a><a class="code" href="struct__ssl__context.html#802e2f38cfc49541a2c265084e63f13d">00222</a>     <span class="keywordtype">int</span> <a class="code" href="struct__ssl__context.html#802e2f38cfc49541a2c265084e63f13d">verify_result</a>;                  
<a name="l00224"></a>00224     <span class="comment">/*</span>
<a name="l00225"></a>00225 <span class="comment">     * Crypto layer</span>
<a name="l00226"></a>00226 <span class="comment">     */</span>
<a name="l00227"></a><a class="code" href="struct__ssl__context.html#6c45dc0e27dbe279966fb32df16786d0">00227</a>      <a class="code" href="structdhm__context.html">dhm_context</a> <a class="code" href="struct__ssl__context.html#6c45dc0e27dbe279966fb32df16786d0">dhm_ctx</a>;               
<a name="l00228"></a><a class="code" href="struct__ssl__context.html#3d46fd168141384ea79fbd9e749e59bb">00228</a>      <a class="code" href="structmd5__context.html">md5_context</a> <a class="code" href="struct__ssl__context.html#3d46fd168141384ea79fbd9e749e59bb">fin_md5</a>;               
<a name="l00229"></a><a class="code" href="struct__ssl__context.html#e7ea8e6dce20f5f617a89bcda62ce58f">00229</a>     <a class="code" href="structsha1__context.html">sha1_context</a> <a class="code" href="struct__ssl__context.html#e7ea8e6dce20f5f617a89bcda62ce58f">fin_sha1</a>;              
<a name="l00231"></a><a class="code" href="struct__ssl__context.html#df65785aab3e7cd1d3c9a5a5bbc06a16">00231</a>     <span class="keywordtype">int</span> <a class="code" href="struct__ssl__context.html#df65785aab3e7cd1d3c9a5a5bbc06a16">do_crypt</a>;                       
<a name="l00232"></a><a class="code" href="struct__ssl__context.html#c614d6ebf1bd613f1985256f90996237">00232</a>     <span class="keywordtype">int</span> *<a class="code" href="struct__ssl__context.html#c614d6ebf1bd613f1985256f90996237">ciphers</a>;                       
<a name="l00233"></a><a class="code" href="struct__ssl__context.html#aeb21b6875d3b322aea8a22443bba2ac">00233</a>     <span class="keywordtype">int</span> <a class="code" href="struct__ssl__context.html#aeb21b6875d3b322aea8a22443bba2ac">pmslen</a>;                         
<a name="l00234"></a><a class="code" href="struct__ssl__context.html#01c980ecb6a743d08b94f4ef8993b5f3">00234</a>     <span class="keywordtype">int</span> <a class="code" href="struct__ssl__context.html#01c980ecb6a743d08b94f4ef8993b5f3">keylen</a>;                         
<a name="l00235"></a><a class="code" href="struct__ssl__context.html#21912b695ed63b10a0cf8d08e1524ead">00235</a>     <span class="keywordtype">int</span> <a class="code" href="struct__ssl__context.html#21912b695ed63b10a0cf8d08e1524ead">minlen</a>;                         
<a name="l00236"></a><a class="code" href="struct__ssl__context.html#c00bf85213cbc0d1277f65d5720e8435">00236</a>     <span class="keywordtype">int</span> <a class="code" href="struct__ssl__context.html#c00bf85213cbc0d1277f65d5720e8435">ivlen</a>;                          
<a name="l00237"></a><a class="code" href="struct__ssl__context.html#52e9f1e459485571eb76f0b95ec78b0b">00237</a>     <span class="keywordtype">int</span> <a class="code" href="struct__ssl__context.html#52e9f1e459485571eb76f0b95ec78b0b">maclen</a>;                         
<a name="l00239"></a><a class="code" href="struct__ssl__context.html#e3c51a174209974a641f644cde0b9aba">00239</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="struct__ssl__context.html#e3c51a174209974a641f644cde0b9aba">randbytes</a>[64];        
<a name="l00240"></a><a class="code" href="struct__ssl__context.html#870785071daa4c05c28efc322c0d48a8">00240</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="struct__ssl__context.html#870785071daa4c05c28efc322c0d48a8">premaster</a>[256];       
<a name="l00242"></a><a class="code" href="struct__ssl__context.html#0958f4f4a6cee0d1aa974595339e454f">00242</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="struct__ssl__context.html#0958f4f4a6cee0d1aa974595339e454f">iv_enc</a>[16];           
<a name="l00243"></a><a class="code" href="struct__ssl__context.html#1a14628bb418b3a582bee208cbbfd745">00243</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="struct__ssl__context.html#1a14628bb418b3a582bee208cbbfd745">iv_dec</a>[16];           
<a name="l00245"></a><a class="code" href="struct__ssl__context.html#448ca03def2b6e0051298187b5fb1b8d">00245</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="struct__ssl__context.html#448ca03def2b6e0051298187b5fb1b8d">mac_enc</a>[32];          
<a name="l00246"></a><a class="code" href="struct__ssl__context.html#2a60ebbde64be08b4599d4379d34e4c1">00246</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="struct__ssl__context.html#2a60ebbde64be08b4599d4379d34e4c1">mac_dec</a>[32];          
<a name="l00248"></a><a class="code" href="struct__ssl__context.html#ed9a06ee3769c9e00f2826f20e20ef63">00248</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="struct__ssl__context.html#ed9a06ee3769c9e00f2826f20e20ef63">ctx_enc</a>[128];         
<a name="l00249"></a><a class="code" href="struct__ssl__context.html#b04283d802958292a77e1723c644bee5">00249</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="struct__ssl__context.html#b04283d802958292a77e1723c644bee5">ctx_dec</a>[128];         
<a name="l00251"></a>00251     <span class="comment">/*</span>
<a name="l00252"></a>00252 <span class="comment">     * TLS extensions</span>
<a name="l00253"></a>00253 <span class="comment">     */</span>
<a name="l00254"></a><a class="code" href="struct__ssl__context.html#28d2e9b2e002adca9750e8844c5f5f20">00254</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="struct__ssl__context.html#28d2e9b2e002adca9750e8844c5f5f20">hostname</a>;
<a name="l00255"></a><a class="code" href="struct__ssl__context.html#7d3e39b36260aa94ec4e6a88f5bd19de">00255</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  <a class="code" href="struct__ssl__context.html#7d3e39b36260aa94ec4e6a88f5bd19de">hostname_len</a>;
<a name="l00256"></a>00256 };
<a name="l00257"></a>00257 
<a name="l00258"></a>00258 <span class="preprocessor">#ifdef __cplusplus</span>
<a name="l00259"></a>00259 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> {
<a name="l00260"></a>00260 <span class="preprocessor">#endif</span>
<a name="l00261"></a>00261 <span class="preprocessor"></span>
<a name="l00262"></a>00262 <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="ssl_8h.html#07a6d5fb8775bc57dcaf42b8a8c82ff7">ssl_default_ciphers</a>[];
<a name="l00263"></a>00263 
<a name="l00271"></a>00271 <span class="keywordtype">int</span> <a class="code" href="ssl_8h.html#dd102a477ee9b9d9cda8fb1b86313d2e">ssl_init</a>( <a class="code" href="ssl_8h.html#6cc90742039ba6f9fa184c22af7ea151">ssl_context</a> *ssl );
<a name="l00272"></a>00272 
<a name="l00279"></a>00279 <span class="keywordtype">void</span> <a class="code" href="ssl_8h.html#3b71db44f3dd86fb3d4da60401a9dc0f">ssl_set_endpoint</a>( <a class="code" href="ssl_8h.html#6cc90742039ba6f9fa184c22af7ea151">ssl_context</a> *ssl, <span class="keywordtype">int</span> endpoint );
<a name="l00280"></a>00280 
<a name="l00298"></a>00298 <span class="keywordtype">void</span> <a class="code" href="ssl_8h.html#12548c85c004225593c930c83b08a109">ssl_set_authmode</a>( <a class="code" href="ssl_8h.html#6cc90742039ba6f9fa184c22af7ea151">ssl_context</a> *ssl, <span class="keywordtype">int</span> authmode );
<a name="l00299"></a>00299 
<a name="l00307"></a>00307 <span class="keywordtype">void</span> <a class="code" href="ssl_8h.html#dc5f63c5d93e557d6a4256613155ad83">ssl_set_rng</a>( <a class="code" href="ssl_8h.html#6cc90742039ba6f9fa184c22af7ea151">ssl_context</a> *ssl,
<a name="l00308"></a>00308                   <span class="keywordtype">int</span> (*f_rng)(<span class="keywordtype">void</span> *),
<a name="l00309"></a>00309                   <span class="keywordtype">void</span> *p_rng );
<a name="l00310"></a>00310 
<a name="l00318"></a>00318 <span class="keywordtype">void</span> <a class="code" href="ssl_8h.html#80d455f109f1f6e050aa7bab835c5848">ssl_set_dbg</a>( <a class="code" href="ssl_8h.html#6cc90742039ba6f9fa184c22af7ea151">ssl_context</a> *ssl,
<a name="l00319"></a>00319                   <span class="keywordtype">void</span> (*f_dbg)(<span class="keywordtype">void</span> *, <span class="keywordtype">int</span>, <span class="keywordtype">char</span> *),
<a name="l00320"></a>00320                   <span class="keywordtype">void</span>  *p_dbg );
<a name="l00321"></a>00321 
<a name="l00331"></a>00331 <span class="keywordtype">void</span> <a class="code" href="ssl_8h.html#5fe35c2ffbb850964388e2085d7f22a4">ssl_set_bio</a>( <a class="code" href="ssl_8h.html#6cc90742039ba6f9fa184c22af7ea151">ssl_context</a> *ssl,
<a name="l00332"></a>00332         <span class="keywordtype">int</span> (*f_recv)(<span class="keywordtype">void</span> *, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *, <span class="keywordtype">int</span>), <span class="keywordtype">void</span> *p_recv,
<a name="l00333"></a>00333         <span class="keywordtype">int</span> (*f_send)(<span class="keywordtype">void</span> *, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *, <span class="keywordtype">int</span>), <span class="keywordtype">void</span> *p_send );
<a name="l00334"></a>00334 
<a name="l00342"></a>00342 <span class="keywordtype">void</span> <a class="code" href="ssl_8h.html#88bd6f38c238703d38bfe9f8db49efb7">ssl_set_scb</a>( <a class="code" href="ssl_8h.html#6cc90742039ba6f9fa184c22af7ea151">ssl_context</a> *ssl,
<a name="l00343"></a>00343                   <span class="keywordtype">int</span> (*s_get)(<a class="code" href="ssl_8h.html#6cc90742039ba6f9fa184c22af7ea151">ssl_context</a> *),
<a name="l00344"></a>00344                   <span class="keywordtype">int</span> (*s_set)(ssl_context *) );
<a name="l00345"></a>00345 
<a name="l00354"></a>00354 <span class="keywordtype">void</span> <a class="code" href="ssl_8h.html#227f2d1077c32f6d901e6884c09c460d">ssl_set_session</a>( ssl_context *ssl, <span class="keywordtype">int</span> resume, <span class="keywordtype">int</span> timeout,
<a name="l00355"></a>00355                       <a class="code" href="ssl_8h.html#bb59b301c07806142c790115fa49eb9e">ssl_session</a> *session );
<a name="l00356"></a>00356 
<a name="l00363"></a>00363 <span class="keywordtype">void</span> <a class="code" href="ssl_8h.html#754095125a0363659a837b4955b42a32">ssl_set_ciphers</a>( ssl_context *ssl, <span class="keywordtype">int</span> *ciphers );
<a name="l00364"></a>00364 
<a name="l00374"></a>00374 <span class="keywordtype">void</span> <a class="code" href="ssl_8h.html#6571603078bdff778e04618ee449e1d6">ssl_set_ca_chain</a>( ssl_context *ssl, <a class="code" href="struct__x509__cert.html">x509_cert</a> *ca_chain,
<a name="l00375"></a>00375                        <span class="keywordtype">char</span> *peer_cn );
<a name="l00376"></a>00376 
<a name="l00384"></a>00384 <span class="keywordtype">void</span> <a class="code" href="ssl_8h.html#211c7efa65a306d62cd5856b3b380275">ssl_set_own_cert</a>( ssl_context *ssl, <a class="code" href="struct__x509__cert.html">x509_cert</a> *own_cert,
<a name="l00385"></a>00385                        <a class="code" href="structrsa__context.html">rsa_context</a> *rsa_key );
<a name="l00386"></a>00386 
<a name="l00397"></a>00397 <span class="keywordtype">int</span> <a class="code" href="ssl_8h.html#4c82bc2a64e39d4294b220ff3420a7b2">ssl_set_dh_param</a>( ssl_context *ssl, <span class="keywordtype">char</span> *dhm_P, <span class="keywordtype">char</span> *dhm_G );
<a name="l00398"></a>00398 
<a name="l00408"></a>00408 <span class="keywordtype">int</span> <a class="code" href="ssl_8h.html#aa5d14928eb635516bf695dcb2811a78">ssl_set_hostname</a>( ssl_context *ssl, <span class="keywordtype">char</span> *hostname );
<a name="l00409"></a>00409 
<a name="l00417"></a>00417 <span class="keywordtype">int</span> <a class="code" href="ssl_8h.html#b30a7ed05e93fa255fbf9af3b69a691f">ssl_get_bytes_avail</a>( ssl_context *ssl );
<a name="l00418"></a>00418 
<a name="l00430"></a>00430 <span class="keywordtype">int</span> <a class="code" href="ssl_8h.html#f3c57bc03c53dacd9dbcfd2a4873bb37">ssl_get_verify_result</a>( ssl_context *ssl );
<a name="l00431"></a>00431 
<a name="l00439"></a>00439 <span class="keywordtype">char</span> *<a class="code" href="ssl_8h.html#a34029fc928f86e15a8c6850babce844">ssl_get_cipher</a>( ssl_context *ssl );
<a name="l00440"></a>00440 
<a name="l00449"></a>00449 <span class="keywordtype">int</span> <a class="code" href="ssl_8h.html#c16d7f3ed66ca2d497b47b0e68d58f20">ssl_handshake</a>( ssl_context *ssl );
<a name="l00450"></a>00450 
<a name="l00461"></a>00461 <span class="keywordtype">int</span> <a class="code" href="ssl_8h.html#6d20f0d848db86fa3d81a2bae080b524">ssl_read</a>( ssl_context *ssl, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *buf, <span class="keywordtype">int</span> len );
<a name="l00462"></a>00462 
<a name="l00477"></a>00477 <span class="keywordtype">int</span> <a class="code" href="ssl_8h.html#5b34b842085f3c8043775393bd091a02">ssl_write</a>( ssl_context *ssl, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *buf, <span class="keywordtype">int</span> len );
<a name="l00478"></a>00478 
<a name="l00482"></a>00482 <span class="keywordtype">int</span> <a class="code" href="ssl_8h.html#b9d44e2a86b85dea525b43ae31269bf7">ssl_close_notify</a>( ssl_context *ssl );
<a name="l00483"></a>00483 
<a name="l00487"></a>00487 <span class="keywordtype">void</span> <a class="code" href="ssl_8h.html#c58911881e51c463abfca52e2143dfd3">ssl_free</a>( ssl_context *ssl );
<a name="l00488"></a>00488 
<a name="l00489"></a>00489 <span class="comment">/*</span>
<a name="l00490"></a>00490 <span class="comment"> * Internal functions (do not call directly)</span>
<a name="l00491"></a>00491 <span class="comment"> */</span>
<a name="l00492"></a>00492 <span class="keywordtype">int</span> <a class="code" href="ssl_8h.html#51adc6b0b94a54058627b86bbc9ef3e1">ssl_handshake_client</a>( ssl_context *ssl );
<a name="l00493"></a>00493 <span class="keywordtype">int</span> <a class="code" href="ssl_8h.html#fd78e826cdb896dbf9dc4cc922fbbab7">ssl_handshake_server</a>( ssl_context *ssl );
<a name="l00494"></a>00494 
<a name="l00495"></a>00495 <span class="keywordtype">int</span> <a class="code" href="ssl_8h.html#5dedff2211a3724e2992c5172389ce33">ssl_derive_keys</a>( ssl_context *ssl );
<a name="l00496"></a>00496 <span class="keywordtype">void</span> <a class="code" href="ssl_8h.html#b7e98b7c44559205426a3f78c7dd4636">ssl_calc_verify</a>( ssl_context *ssl, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> hash[36] );
<a name="l00497"></a>00497 
<a name="l00498"></a>00498 <span class="keywordtype">int</span> <a class="code" href="ssl_8h.html#04bbbb6ff83880a6657b4eb1c2765821">ssl_read_record</a>( ssl_context *ssl );
<a name="l00499"></a>00499 <span class="keywordtype">int</span> <a class="code" href="ssl_8h.html#29eda929bf3c7c737207305d87dacb05">ssl_fetch_input</a>( ssl_context *ssl, <span class="keywordtype">int</span> nb_want );
<a name="l00500"></a>00500 
<a name="l00501"></a>00501 <span class="keywordtype">int</span> <a class="code" href="ssl_8h.html#32550924677c7edf4bb249d1f56916a5">ssl_write_record</a>( ssl_context *ssl );
<a name="l00502"></a>00502 <span class="keywordtype">int</span> <a class="code" href="ssl_8h.html#b54c776878e3d8976c07ddeaa11ef9a4">ssl_flush_output</a>( ssl_context *ssl );
<a name="l00503"></a>00503 
<a name="l00504"></a>00504 <span class="keywordtype">int</span> <a class="code" href="ssl_8h.html#aa6c01a5ac49039a9335f6d452ed9034">ssl_parse_certificate</a>( ssl_context *ssl );
<a name="l00505"></a>00505 <span class="keywordtype">int</span> <a class="code" href="ssl_8h.html#49747db4781cba620844afeeb8c393f3">ssl_write_certificate</a>( ssl_context *ssl );
<a name="l00506"></a>00506 
<a name="l00507"></a>00507 <span class="keywordtype">int</span> <a class="code" href="ssl_8h.html#bd03a1da48523e5aff86920bff119c7e">ssl_parse_change_cipher_spec</a>( ssl_context *ssl );
<a name="l00508"></a>00508 <span class="keywordtype">int</span> <a class="code" href="ssl_8h.html#6613709b99e391d8b166fcee4810dccb">ssl_write_change_cipher_spec</a>( ssl_context *ssl );
<a name="l00509"></a>00509 
<a name="l00510"></a>00510 <span class="keywordtype">int</span> <a class="code" href="ssl_8h.html#b4bc3f2691c2e488329a5f60be6f25fc">ssl_parse_finished</a>( ssl_context *ssl );
<a name="l00511"></a>00511 <span class="keywordtype">int</span> <a class="code" href="ssl_8h.html#6ef4eeb9a03b9a474ff8aa71c9c949da">ssl_write_finished</a>( ssl_context *ssl );
<a name="l00512"></a>00512 
<a name="l00513"></a>00513 <span class="preprocessor">#ifdef __cplusplus</span>
<a name="l00514"></a>00514 <span class="preprocessor"></span>}
<a name="l00515"></a>00515 <span class="preprocessor">#endif</span>
<a name="l00516"></a>00516 <span class="preprocessor"></span>
<a name="l00517"></a>00517 <span class="preprocessor">#endif </span><span class="comment">/* ssl.h */</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sun Mar 16 15:31:51 2008 for XySSL by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
