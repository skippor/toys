<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>XySSL: include/xyssl/x509.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>include/xyssl/x509.h</h1><a href="x509_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00004"></a>00004 <span class="preprocessor">#ifndef XYSSL_X509_H</span>
<a name="l00005"></a>00005 <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_X509_H</span>
<a name="l00006"></a>00006 <span class="preprocessor"></span>
<a name="l00007"></a>00007 <span class="preprocessor">#include "<a class="code" href="rsa_8h.html">xyssl/rsa.h</a>"</span>
<a name="l00008"></a>00008 
<a name="l00009"></a><a class="code" href="x509_8h.html#bb667ef506c9b9d755bc3b5db91b2105">00009</a> <span class="preprocessor">#define XYSSL_ERR_ASN1_OUT_OF_DATA                      -0x0014</span>
<a name="l00010"></a><a class="code" href="x509_8h.html#ce0128b11696b7a529e4274f57d63aaf">00010</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_ASN1_UNEXPECTED_TAG                   -0x0016</span>
<a name="l00011"></a><a class="code" href="x509_8h.html#9ccb6ad36f4de950e4309c7ababedebf">00011</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_ASN1_INVALID_LENGTH                   -0x0018</span>
<a name="l00012"></a><a class="code" href="x509_8h.html#076fe85b40c04befe1cda15a50a02521">00012</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_ASN1_LENGTH_MISMATCH                  -0x001A</span>
<a name="l00013"></a><a class="code" href="x509_8h.html#ffa20d934c9b17f67e2a11661561e9ef">00013</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_ASN1_INVALID_DATA                     -0x001C</span>
<a name="l00014"></a>00014 <span class="preprocessor"></span>
<a name="l00015"></a><a class="code" href="x509_8h.html#31f2b571c3e7a45a81274c58d00ad2a8">00015</a> <span class="preprocessor">#define XYSSL_ERR_X509_FEATURE_UNAVAILABLE              -0x0020</span>
<a name="l00016"></a><a class="code" href="x509_8h.html#7e3ec14e00969db473f9375a3d55d9c4">00016</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_X509_CERT_INVALID_PEM                 -0x0040</span>
<a name="l00017"></a><a class="code" href="x509_8h.html#dcc727eb5817b7f547a32cc2c7db81ff">00017</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_X509_CERT_INVALID_FORMAT              -0x0060</span>
<a name="l00018"></a><a class="code" href="x509_8h.html#7dbf94d1b2b865bdb63e824ebfe5bf35">00018</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_X509_CERT_INVALID_VERSION             -0x0080</span>
<a name="l00019"></a><a class="code" href="x509_8h.html#f196862fb984df6bf88f0e176bb06cf6">00019</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_X509_CERT_INVALID_SERIAL              -0x00A0</span>
<a name="l00020"></a><a class="code" href="x509_8h.html#b5b156a552340c783e764afe54a3ea0b">00020</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_X509_CERT_INVALID_ALG                 -0x00C0</span>
<a name="l00021"></a><a class="code" href="x509_8h.html#a199ecec3c6fb932dd23d54f3760191b">00021</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_X509_CERT_INVALID_NAME                -0x00E0</span>
<a name="l00022"></a><a class="code" href="x509_8h.html#f64e6e5a338847aadc092167567d43dc">00022</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_X509_CERT_INVALID_DATE                -0x0100</span>
<a name="l00023"></a><a class="code" href="x509_8h.html#018a74cf566af99be0e11032a20b7423">00023</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_X509_CERT_INVALID_PUBKEY              -0x0120</span>
<a name="l00024"></a><a class="code" href="x509_8h.html#9b2cae6f5553831a768c62f78af00b11">00024</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_X509_CERT_INVALID_SIGNATURE           -0x0140</span>
<a name="l00025"></a><a class="code" href="x509_8h.html#e09cc350afc1c3ccabd982ee7b75fb2c">00025</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_X509_CERT_INVALID_EXTENSIONS          -0x0160</span>
<a name="l00026"></a><a class="code" href="x509_8h.html#2f667bc2099faa7f36b9b61eba83ec4d">00026</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_X509_CERT_UNKNOWN_VERSION             -0x0180</span>
<a name="l00027"></a><a class="code" href="x509_8h.html#654e051ae63d7f2318f08e11b0b07253">00027</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_X509_CERT_UNKNOWN_SIG_ALG             -0x01A0</span>
<a name="l00028"></a><a class="code" href="x509_8h.html#f2431f0580d91aa4f0b9b48be14c6eaf">00028</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_X509_CERT_UNKNOWN_PK_ALG              -0x01C0</span>
<a name="l00029"></a><a class="code" href="x509_8h.html#ee03c544d6f3b32ad65b04bdc946a49c">00029</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_X509_CERT_SIG_MISMATCH                -0x01E0</span>
<a name="l00030"></a><a class="code" href="x509_8h.html#9c501fe6405d905c4340bc8523f1dc45">00030</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_X509_CERT_VERIFY_FAILED               -0x0200</span>
<a name="l00031"></a><a class="code" href="x509_8h.html#bf898f967cd147a5ad5a740f06f50ec2">00031</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_X509_KEY_INVALID_PEM                  -0x0220</span>
<a name="l00032"></a><a class="code" href="x509_8h.html#1e258f017ea230845b207e779382d77b">00032</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_X509_KEY_INVALID_VERSION              -0x0240</span>
<a name="l00033"></a><a class="code" href="x509_8h.html#ae3f72311cc2f7d760ac983d1c96dba8">00033</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_X509_KEY_INVALID_FORMAT               -0x0260</span>
<a name="l00034"></a><a class="code" href="x509_8h.html#034a785dba5c9426a45cb238ebbbe1f9">00034</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_X509_KEY_INVALID_ENC_IV               -0x0280</span>
<a name="l00035"></a><a class="code" href="x509_8h.html#69a532ede1e49aff2391835fd8964dc4">00035</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_X509_KEY_UNKNOWN_ENC_ALG              -0x02A0</span>
<a name="l00036"></a><a class="code" href="x509_8h.html#9267e2acf09026d394905f7eed9b6b5c">00036</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_X509_KEY_PASSWORD_REQUIRED            -0x02C0</span>
<a name="l00037"></a><a class="code" href="x509_8h.html#9ade2f098cc4e0fed08aafedff0e1eb7">00037</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_X509_KEY_PASSWORD_MISMATCH            -0x02E0</span>
<a name="l00038"></a><a class="code" href="x509_8h.html#83b8979674c0168bfd4eefd3faf7492f">00038</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_X509_POINT_ERROR                      -0x0300</span>
<a name="l00039"></a><a class="code" href="x509_8h.html#f7cd4f4dd3cdd38c286e432642a293f3">00039</a> <span class="preprocessor"></span><span class="preprocessor">#define XYSSL_ERR_X509_VALUE_TO_LENGTH                  -0x0320</span>
<a name="l00040"></a>00040 <span class="preprocessor"></span>
<a name="l00041"></a><a class="code" href="x509_8h.html#64e936014215ef18f026ff101b6f8369">00041</a> <span class="preprocessor">#define BADCERT_EXPIRED                 1</span>
<a name="l00042"></a><a class="code" href="x509_8h.html#4ecb1ad0da0f9d6bb0017e091ea4ee2a">00042</a> <span class="preprocessor"></span><span class="preprocessor">#define BADCERT_REVOKED                 2</span>
<a name="l00043"></a><a class="code" href="x509_8h.html#cfafc04b8cd60bd1819cf41bc78a24de">00043</a> <span class="preprocessor"></span><span class="preprocessor">#define BADCERT_CN_MISMATCH             4</span>
<a name="l00044"></a><a class="code" href="x509_8h.html#71c9686585580f77964a3653e147ad0a">00044</a> <span class="preprocessor"></span><span class="preprocessor">#define BADCERT_NOT_TRUSTED             8</span>
<a name="l00045"></a>00045 <span class="preprocessor"></span>
<a name="l00046"></a>00046 <span class="comment">/*</span>
<a name="l00047"></a>00047 <span class="comment"> * DER constants</span>
<a name="l00048"></a>00048 <span class="comment"> */</span>
<a name="l00049"></a><a class="code" href="x509_8h.html#5ecb3f6655f48694a6326657290d4996">00049</a> <span class="preprocessor">#define ASN1_BOOLEAN                 0x01</span>
<a name="l00050"></a><a class="code" href="x509_8h.html#0d3b979ef2ca9618ec1899fd0e14d8ec">00050</a> <span class="preprocessor"></span><span class="preprocessor">#define ASN1_INTEGER                 0x02</span>
<a name="l00051"></a><a class="code" href="x509_8h.html#1493defdd429594af36feaf6309cc70a">00051</a> <span class="preprocessor"></span><span class="preprocessor">#define ASN1_BIT_STRING              0x03</span>
<a name="l00052"></a><a class="code" href="x509_8h.html#e251e2c2d40228a89468f3f939a18585">00052</a> <span class="preprocessor"></span><span class="preprocessor">#define ASN1_OCTET_STRING            0x04</span>
<a name="l00053"></a><a class="code" href="x509_8h.html#381db5db1873cb0b03744322cd9bc19c">00053</a> <span class="preprocessor"></span><span class="preprocessor">#define ASN1_NULL                    0x05</span>
<a name="l00054"></a><a class="code" href="x509_8h.html#3fef844d0ea67080b66b3a4d5f0a9ec8">00054</a> <span class="preprocessor"></span><span class="preprocessor">#define ASN1_OID                     0x06</span>
<a name="l00055"></a><a class="code" href="x509_8h.html#0dcba566de60f1776d36931ac1733b8d">00055</a> <span class="preprocessor"></span><span class="preprocessor">#define ASN1_UTF8_STRING             0x0C</span>
<a name="l00056"></a><a class="code" href="x509_8h.html#9321fc9f2a5ef4103008fbe5c4b230df">00056</a> <span class="preprocessor"></span><span class="preprocessor">#define ASN1_SEQUENCE                0x10</span>
<a name="l00057"></a><a class="code" href="x509_8h.html#aa4097914560e5318d1c316106b38998">00057</a> <span class="preprocessor"></span><span class="preprocessor">#define ASN1_SET                     0x11</span>
<a name="l00058"></a><a class="code" href="x509_8h.html#9d250073c32cfa2d0f90a92fa9485c89">00058</a> <span class="preprocessor"></span><span class="preprocessor">#define ASN1_PRINTABLE_STRING        0x13</span>
<a name="l00059"></a><a class="code" href="x509_8h.html#ecb31acd8c2e58371f4cc5163f13ee3e">00059</a> <span class="preprocessor"></span><span class="preprocessor">#define ASN1_T61_STRING              0x14</span>
<a name="l00060"></a><a class="code" href="x509_8h.html#45d8160d9158c5e040db66bb79fc8f18">00060</a> <span class="preprocessor"></span><span class="preprocessor">#define ASN1_IA5_STRING              0x16</span>
<a name="l00061"></a><a class="code" href="x509_8h.html#94a96a45489af8cb19d6dd3ee76eefb2">00061</a> <span class="preprocessor"></span><span class="preprocessor">#define ASN1_UTC_TIME                0x17</span>
<a name="l00062"></a><a class="code" href="x509_8h.html#7571a2e3383313e9a36cf168b707b4f9">00062</a> <span class="preprocessor"></span><span class="preprocessor">#define ASN1_UNIVERSAL_STRING        0x1C</span>
<a name="l00063"></a><a class="code" href="x509_8h.html#e17ad2492005596109a4179b6f22cc62">00063</a> <span class="preprocessor"></span><span class="preprocessor">#define ASN1_BMP_STRING              0x1E</span>
<a name="l00064"></a><a class="code" href="x509_8h.html#d61fcc873df5268453d3064aa11ffbca">00064</a> <span class="preprocessor"></span><span class="preprocessor">#define ASN1_PRIMITIVE               0x00</span>
<a name="l00065"></a><a class="code" href="x509_8h.html#799d7b17a9532e1dadc8355f04477e27">00065</a> <span class="preprocessor"></span><span class="preprocessor">#define ASN1_CONSTRUCTED             0x20</span>
<a name="l00066"></a><a class="code" href="x509_8h.html#b1f89bc6e469d46d5293f724d317d1d7">00066</a> <span class="preprocessor"></span><span class="preprocessor">#define ASN1_CONTEXT_SPECIFIC        0x80</span>
<a name="l00067"></a>00067 <span class="preprocessor"></span>
<a name="l00068"></a>00068 <span class="comment">/*</span>
<a name="l00069"></a>00069 <span class="comment"> * various object identifiers</span>
<a name="l00070"></a>00070 <span class="comment"> */</span>
<a name="l00071"></a><a class="code" href="x509_8h.html#45a04f9d89dc80c1a69b988dac53563d">00071</a> <span class="preprocessor">#define X520_COMMON_NAME                3</span>
<a name="l00072"></a><a class="code" href="x509_8h.html#80196d37e746a915063c85f99d76e41e">00072</a> <span class="preprocessor"></span><span class="preprocessor">#define X520_COUNTRY                    6</span>
<a name="l00073"></a><a class="code" href="x509_8h.html#c00597e7a5f5c41f04599940f078d842">00073</a> <span class="preprocessor"></span><span class="preprocessor">#define X520_LOCALITY                   7</span>
<a name="l00074"></a><a class="code" href="x509_8h.html#25857f18441d509658731ff393fd86f2">00074</a> <span class="preprocessor"></span><span class="preprocessor">#define X520_STATE                      8</span>
<a name="l00075"></a><a class="code" href="x509_8h.html#f17ab905a8f8c2d4739c5983391acc8b">00075</a> <span class="preprocessor"></span><span class="preprocessor">#define X520_ORGANIZATION              10</span>
<a name="l00076"></a><a class="code" href="x509_8h.html#340c757a1a41734fce5aab4e0d2c6eb8">00076</a> <span class="preprocessor"></span><span class="preprocessor">#define X520_ORG_UNIT                  11</span>
<a name="l00077"></a><a class="code" href="x509_8h.html#3a00b91e03940df9994a7e27ea7b3695">00077</a> <span class="preprocessor"></span><span class="preprocessor">#define PKCS9_EMAIL                     1</span>
<a name="l00078"></a>00078 <span class="preprocessor"></span>
<a name="l00079"></a><a class="code" href="x509_8h.html#bab555b94383b8ef98fce9d42b209a04">00079</a> <span class="preprocessor">#define X509_OUTPUT_DER              0x01</span>
<a name="l00080"></a><a class="code" href="x509_8h.html#4b53420a9891a18cf07950833eb60b5a">00080</a> <span class="preprocessor"></span><span class="preprocessor">#define X509_OUTPUT_PEM              0x02</span>
<a name="l00081"></a><a class="code" href="x509_8h.html#70f13ab2a0c7daff105590e6ef3dd479">00081</a> <span class="preprocessor"></span><span class="preprocessor">#define PEM_LINE_LENGTH                72</span>
<a name="l00082"></a><a class="code" href="x509_8h.html#f08572ebc0abbb56da4c3b617099056c">00082</a> <span class="preprocessor"></span><span class="preprocessor">#define X509_ISSUER                  0x01</span>
<a name="l00083"></a><a class="code" href="x509_8h.html#613a62c3fb286f4d34ec655967e11907">00083</a> <span class="preprocessor"></span><span class="preprocessor">#define X509_SUBJECT                 0x02</span>
<a name="l00084"></a>00084 <span class="preprocessor"></span>
<a name="l00085"></a><a class="code" href="x509_8h.html#6e761e5b4deffb65783125d8382f83b4">00085</a> <span class="preprocessor">#define OID_X520                "\x55\x04"</span>
<a name="l00086"></a><a class="code" href="x509_8h.html#c252df2e2ddb1b2772f0fc803fade904">00086</a> <span class="preprocessor"></span><span class="preprocessor">#define OID_CN                  "\x55\x04\x03"</span>
<a name="l00087"></a><a class="code" href="x509_8h.html#ffd3c6c6b6029897c09631c9e71b5775">00087</a> <span class="preprocessor"></span><span class="preprocessor">#define OID_PKCS1               "\x2A\x86\x48\x86\xF7\x0D\x01\x01"</span>
<a name="l00088"></a><a class="code" href="x509_8h.html#89f411612e522c42397ebfd1f9b83fef">00088</a> <span class="preprocessor"></span><span class="preprocessor">#define OID_PKCS1_RSA           "\x2A\x86\x48\x86\xF7\x0D\x01\x01\x01"</span>
<a name="l00089"></a><a class="code" href="x509_8h.html#2b1eb72939149c38ae15c365a8ea890f">00089</a> <span class="preprocessor"></span><span class="preprocessor">#define OID_PKCS1_RSA_SHA       "\x2A\x86\x48\x86\xF7\x0D\x01\x01\x05"</span>
<a name="l00090"></a><a class="code" href="x509_8h.html#83854c65d3947ccff4c7b6b1dc2195b2">00090</a> <span class="preprocessor"></span><span class="preprocessor">#define OID_PKCS9               "\x2A\x86\x48\x86\xF7\x0D\x01\x09"</span>
<a name="l00091"></a><a class="code" href="x509_8h.html#f0fac7acdd45c0c38eb50aa675c73f54">00091</a> <span class="preprocessor"></span><span class="preprocessor">#define OID_PKCS9_EMAIL         "\x2A\x86\x48\x86\xF7\x0D\x01\x09\x01"</span>
<a name="l00092"></a>00092 <span class="preprocessor"></span>
<a name="l00093"></a>00093 <span class="comment">/*</span>
<a name="l00094"></a>00094 <span class="comment"> * Structures for parsing X.509 certificates</span>
<a name="l00095"></a>00095 <span class="comment"> */</span>
<a name="l00096"></a><a class="code" href="struct__x509__buf.html">00096</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__x509__buf.html">_x509_buf</a>
<a name="l00097"></a>00097 {
<a name="l00098"></a><a class="code" href="struct__x509__buf.html#9a426eedaa6529cdacb73a0fde6686b4">00098</a>     <span class="keywordtype">int</span> <a class="code" href="struct__x509__buf.html#9a426eedaa6529cdacb73a0fde6686b4">tag</a>;
<a name="l00099"></a><a class="code" href="struct__x509__buf.html#f829206f46236ab9b0b8f6a3810d45f5">00099</a>     <span class="keywordtype">int</span> <a class="code" href="struct__x509__buf.html#f829206f46236ab9b0b8f6a3810d45f5">len</a>;
<a name="l00100"></a><a class="code" href="struct__x509__buf.html#493ae4efc0e4f4718f220213737d65cc">00100</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="struct__x509__buf.html#493ae4efc0e4f4718f220213737d65cc">p</a>;
<a name="l00101"></a>00101 }
<a name="l00102"></a>00102 <a class="code" href="struct__x509__buf.html">x509_buf</a>;
<a name="l00103"></a>00103 
<a name="l00104"></a><a class="code" href="struct__x509__name.html">00104</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__x509__name.html">_x509_name</a>
<a name="l00105"></a>00105 {
<a name="l00106"></a><a class="code" href="struct__x509__name.html#bcc8894d532fc2da3c1ba58f26caa8c5">00106</a>     <a class="code" href="struct__x509__buf.html">x509_buf</a> <a class="code" href="struct__x509__name.html#bcc8894d532fc2da3c1ba58f26caa8c5">oid</a>;
<a name="l00107"></a><a class="code" href="struct__x509__name.html#942c2eca006c7a0076fdd5103c008a0e">00107</a>     <a class="code" href="struct__x509__buf.html">x509_buf</a> <a class="code" href="struct__x509__name.html#942c2eca006c7a0076fdd5103c008a0e">val</a>;
<a name="l00108"></a><a class="code" href="struct__x509__name.html#86560b113b91a294b43ff39f647988e9">00108</a>     <span class="keyword">struct </span><a class="code" href="struct__x509__name.html">_x509_name</a> *<a class="code" href="struct__x509__name.html#86560b113b91a294b43ff39f647988e9">next</a>;
<a name="l00109"></a>00109 }
<a name="l00110"></a>00110 <a class="code" href="struct__x509__name.html">x509_name</a>;
<a name="l00111"></a>00111 
<a name="l00112"></a><a class="code" href="struct__x509__time.html">00112</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__x509__time.html">_x509_time</a>
<a name="l00113"></a>00113 {
<a name="l00114"></a><a class="code" href="struct__x509__time.html#26ed64caf8b2d05ecb82c0ed68113bc5">00114</a>     <span class="keywordtype">int</span> <a class="code" href="struct__x509__time.html#26ed64caf8b2d05ecb82c0ed68113bc5">year</a>, <a class="code" href="struct__x509__time.html#a89934c680dcbbb1a74a6ff3f83da264">mon</a>, <a class="code" href="struct__x509__time.html#20c84d21414653a33595ea4563c49b46">day</a>;
<a name="l00115"></a><a class="code" href="struct__x509__time.html#61b09ab58c9d829c4a258ac1a63fff3d">00115</a>     <span class="keywordtype">int</span> <a class="code" href="struct__x509__time.html#52a420b0bb4513b257c239f967187d97">hour</a>, <a class="code" href="struct__x509__time.html#7ef645e874ef1dac4767713f131f6425">min</a>, <a class="code" href="struct__x509__time.html#61b09ab58c9d829c4a258ac1a63fff3d">sec</a>;
<a name="l00116"></a>00116 }
<a name="l00117"></a>00117 <a class="code" href="struct__x509__time.html">x509_time</a>;
<a name="l00118"></a>00118 
<a name="l00119"></a><a class="code" href="struct__x509__cert.html">00119</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__x509__cert.html">_x509_cert</a>
<a name="l00120"></a>00120 {
<a name="l00121"></a><a class="code" href="struct__x509__cert.html#aa3c5176ea8d5b0b331977f700b9cbb9">00121</a>     <a class="code" href="struct__x509__buf.html">x509_buf</a> <a class="code" href="struct__x509__cert.html#aa3c5176ea8d5b0b331977f700b9cbb9">raw</a>;
<a name="l00122"></a><a class="code" href="struct__x509__cert.html#6240a75b6cd91b3f6375f9cfde898d8c">00122</a>     <a class="code" href="struct__x509__buf.html">x509_buf</a> <a class="code" href="struct__x509__cert.html#6240a75b6cd91b3f6375f9cfde898d8c">tbs</a>;
<a name="l00123"></a>00123 
<a name="l00124"></a><a class="code" href="struct__x509__cert.html#70a1b52b8baf5c8106aa5858d207693a">00124</a>     <span class="keywordtype">int</span> <a class="code" href="struct__x509__cert.html#70a1b52b8baf5c8106aa5858d207693a">version</a>;
<a name="l00125"></a><a class="code" href="struct__x509__cert.html#27ac7ba974218a405e2ba3801ede78cb">00125</a>     <a class="code" href="struct__x509__buf.html">x509_buf</a> <a class="code" href="struct__x509__cert.html#27ac7ba974218a405e2ba3801ede78cb">serial</a>;
<a name="l00126"></a><a class="code" href="struct__x509__cert.html#a99b825b6bd8ca901838f445ac6a6f8f">00126</a>     <a class="code" href="struct__x509__buf.html">x509_buf</a> <a class="code" href="struct__x509__cert.html#a99b825b6bd8ca901838f445ac6a6f8f">sig_oid1</a>;
<a name="l00127"></a>00127 
<a name="l00128"></a><a class="code" href="struct__x509__cert.html#0c3dffb54445833783cb5a3dbe43ce7f">00128</a>     <a class="code" href="struct__x509__buf.html">x509_buf</a> <a class="code" href="struct__x509__cert.html#0c3dffb54445833783cb5a3dbe43ce7f">issuer_raw</a>;
<a name="l00129"></a><a class="code" href="struct__x509__cert.html#31c06c45f6bf533c12b70f36ded098c7">00129</a>     <a class="code" href="struct__x509__buf.html">x509_buf</a> <a class="code" href="struct__x509__cert.html#31c06c45f6bf533c12b70f36ded098c7">subject_raw</a>;
<a name="l00130"></a>00130 
<a name="l00131"></a><a class="code" href="struct__x509__cert.html#7104e7449683a718da74236f9557eb5d">00131</a>     <a class="code" href="struct__x509__name.html">x509_name</a> <a class="code" href="struct__x509__cert.html#7104e7449683a718da74236f9557eb5d">issuer</a>;
<a name="l00132"></a><a class="code" href="struct__x509__cert.html#63435c22419b3ac17eca35572e026dad">00132</a>     <a class="code" href="struct__x509__name.html">x509_name</a> <a class="code" href="struct__x509__cert.html#63435c22419b3ac17eca35572e026dad">subject</a>;
<a name="l00133"></a>00133 
<a name="l00134"></a><a class="code" href="struct__x509__cert.html#a33216ab6b83ed3dcc803366a097b75d">00134</a>     <a class="code" href="struct__x509__time.html">x509_time</a> <a class="code" href="struct__x509__cert.html#a33216ab6b83ed3dcc803366a097b75d">valid_from</a>;
<a name="l00135"></a><a class="code" href="struct__x509__cert.html#37ffbe99c241d4608283a83534c9b6b0">00135</a>     <a class="code" href="struct__x509__time.html">x509_time</a> <a class="code" href="struct__x509__cert.html#37ffbe99c241d4608283a83534c9b6b0">valid_to</a>;
<a name="l00136"></a>00136 
<a name="l00137"></a><a class="code" href="struct__x509__cert.html#3f01bb720153dcb377dc43f28ed515f8">00137</a>     <a class="code" href="struct__x509__buf.html">x509_buf</a> <a class="code" href="struct__x509__cert.html#3f01bb720153dcb377dc43f28ed515f8">pk_oid</a>;
<a name="l00138"></a><a class="code" href="struct__x509__cert.html#68451602289de6385668d7ea2ba7bf41">00138</a>     <a class="code" href="structrsa__context.html">rsa_context</a> <a class="code" href="struct__x509__cert.html#68451602289de6385668d7ea2ba7bf41">rsa</a>;
<a name="l00139"></a>00139 
<a name="l00140"></a><a class="code" href="struct__x509__cert.html#1799680861fc99a318614279700a9e73">00140</a>     <a class="code" href="struct__x509__buf.html">x509_buf</a> <a class="code" href="struct__x509__cert.html#1799680861fc99a318614279700a9e73">issuer_id</a>;
<a name="l00141"></a><a class="code" href="struct__x509__cert.html#1cd2ef7fe9edd878686103d3835f5e05">00141</a>     <a class="code" href="struct__x509__buf.html">x509_buf</a> <a class="code" href="struct__x509__cert.html#1cd2ef7fe9edd878686103d3835f5e05">subject_id</a>;
<a name="l00142"></a><a class="code" href="struct__x509__cert.html#e7194afcc960a4ff8ece698efc11c59c">00142</a>     <a class="code" href="struct__x509__buf.html">x509_buf</a> <a class="code" href="struct__x509__cert.html#e7194afcc960a4ff8ece698efc11c59c">v3_ext</a>;
<a name="l00143"></a>00143 
<a name="l00144"></a><a class="code" href="struct__x509__cert.html#60faebf186883a4da9422fa81518e54d">00144</a>     <span class="keywordtype">int</span> <a class="code" href="struct__x509__cert.html#60faebf186883a4da9422fa81518e54d">ca_istrue</a>;
<a name="l00145"></a><a class="code" href="struct__x509__cert.html#c67018b5b13170a5a23370c2900773ad">00145</a>     <span class="keywordtype">int</span> <a class="code" href="struct__x509__cert.html#c67018b5b13170a5a23370c2900773ad">max_pathlen</a>;
<a name="l00146"></a>00146 
<a name="l00147"></a><a class="code" href="struct__x509__cert.html#864350ffb262ec52c910f43e97c2923e">00147</a>     <a class="code" href="struct__x509__buf.html">x509_buf</a> <a class="code" href="struct__x509__cert.html#864350ffb262ec52c910f43e97c2923e">sig_oid2</a>;
<a name="l00148"></a><a class="code" href="struct__x509__cert.html#a84d112f3a471915f878520c5f458b30">00148</a>     <a class="code" href="struct__x509__buf.html">x509_buf</a> <a class="code" href="struct__x509__cert.html#a84d112f3a471915f878520c5f458b30">sig</a>;
<a name="l00149"></a>00149 
<a name="l00150"></a><a class="code" href="struct__x509__cert.html#fae9706c38859807b5327fb0865ccc34">00150</a>     <span class="keyword">struct </span><a class="code" href="struct__x509__cert.html">_x509_cert</a> *<a class="code" href="struct__x509__cert.html#fae9706c38859807b5327fb0865ccc34">next</a>; 
<a name="l00151"></a>00151 }
<a name="l00152"></a>00152 <a class="code" href="struct__x509__cert.html">x509_cert</a>;
<a name="l00153"></a>00153 
<a name="l00154"></a>00154 <span class="comment">/*</span>
<a name="l00155"></a>00155 <span class="comment"> * Structures for writing X.509 certificates</span>
<a name="l00156"></a>00156 <span class="comment"> */</span>
<a name="l00157"></a><a class="code" href="struct__x509__node.html">00157</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__x509__node.html">_x509_node</a>
<a name="l00158"></a>00158 {
<a name="l00159"></a><a class="code" href="struct__x509__node.html#72d91b7dca31effed647caa71ef436c8">00159</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="struct__x509__node.html#72d91b7dca31effed647caa71ef436c8">data</a>;
<a name="l00160"></a><a class="code" href="struct__x509__node.html#a26356837ba4508a0e9f616dc5211580">00160</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="struct__x509__node.html#a26356837ba4508a0e9f616dc5211580">p</a>;
<a name="l00161"></a><a class="code" href="struct__x509__node.html#3c0e3bc305af39591b810498bc9084de">00161</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="struct__x509__node.html#3c0e3bc305af39591b810498bc9084de">end</a>;
<a name="l00162"></a>00162 
<a name="l00163"></a><a class="code" href="struct__x509__node.html#c7b7b5cf32edd241daeb49c46a090b6a">00163</a>     size_t <a class="code" href="struct__x509__node.html#c7b7b5cf32edd241daeb49c46a090b6a">len</a>;
<a name="l00164"></a>00164 }
<a name="l00165"></a>00165 <a class="code" href="struct__x509__node.html">x509_node</a>;
<a name="l00166"></a>00166 
<a name="l00167"></a><a class="code" href="struct__x509__raw.html">00167</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__x509__raw.html">_x509_raw</a>
<a name="l00168"></a>00168 {
<a name="l00169"></a><a class="code" href="struct__x509__raw.html#87892d9bad6a94a5357b9c11f82598e5">00169</a>     <a class="code" href="struct__x509__node.html">x509_node</a> <a class="code" href="struct__x509__raw.html#87892d9bad6a94a5357b9c11f82598e5">raw</a>;
<a name="l00170"></a><a class="code" href="struct__x509__raw.html#6c960256d4f6a1531c54abffe86fd4fc">00170</a>     <a class="code" href="struct__x509__node.html">x509_node</a> <a class="code" href="struct__x509__raw.html#6c960256d4f6a1531c54abffe86fd4fc">tbs</a>;
<a name="l00171"></a>00171 
<a name="l00172"></a><a class="code" href="struct__x509__raw.html#a799efa7e5f50dbe0cfa6b35df505159">00172</a>     <a class="code" href="struct__x509__node.html">x509_node</a> <a class="code" href="struct__x509__raw.html#a799efa7e5f50dbe0cfa6b35df505159">version</a>;
<a name="l00173"></a><a class="code" href="struct__x509__raw.html#d1230712e6b1ca4f5f1669f433b9d50d">00173</a>     <a class="code" href="struct__x509__node.html">x509_node</a> <a class="code" href="struct__x509__raw.html#d1230712e6b1ca4f5f1669f433b9d50d">serial</a>;
<a name="l00174"></a><a class="code" href="struct__x509__raw.html#27d8337765d3b551f7b0618e1210ca0a">00174</a>     <a class="code" href="struct__x509__node.html">x509_node</a> <a class="code" href="struct__x509__raw.html#27d8337765d3b551f7b0618e1210ca0a">tbs_signalg</a>;
<a name="l00175"></a><a class="code" href="struct__x509__raw.html#99a22c7b0ce73737675a04d036d7dd0d">00175</a>     <a class="code" href="struct__x509__node.html">x509_node</a> <a class="code" href="struct__x509__raw.html#99a22c7b0ce73737675a04d036d7dd0d">issuer</a>;
<a name="l00176"></a><a class="code" href="struct__x509__raw.html#03498e907ca8e97da5b3df514fde3c76">00176</a>     <a class="code" href="struct__x509__node.html">x509_node</a> <a class="code" href="struct__x509__raw.html#03498e907ca8e97da5b3df514fde3c76">validity</a>;
<a name="l00177"></a><a class="code" href="struct__x509__raw.html#9f0c6ede3e616ee8d42cf9187cdaa36b">00177</a>     <a class="code" href="struct__x509__node.html">x509_node</a> <a class="code" href="struct__x509__raw.html#9f0c6ede3e616ee8d42cf9187cdaa36b">subject</a>;
<a name="l00178"></a><a class="code" href="struct__x509__raw.html#f889d6e19db88186149e7b997b014466">00178</a>     <a class="code" href="struct__x509__node.html">x509_node</a> <a class="code" href="struct__x509__raw.html#f889d6e19db88186149e7b997b014466">subpubkey</a>;
<a name="l00179"></a>00179 
<a name="l00180"></a><a class="code" href="struct__x509__raw.html#bad8a03c750c0f7183ece351345b28a3">00180</a>     <a class="code" href="struct__x509__node.html">x509_node</a> <a class="code" href="struct__x509__raw.html#bad8a03c750c0f7183ece351345b28a3">signalg</a>;
<a name="l00181"></a><a class="code" href="struct__x509__raw.html#5c11d4fd001ba161fe058c6d08029a80">00181</a>     <a class="code" href="struct__x509__node.html">x509_node</a> <a class="code" href="struct__x509__raw.html#5c11d4fd001ba161fe058c6d08029a80">sign</a>;
<a name="l00182"></a>00182 }
<a name="l00183"></a>00183 <a class="code" href="struct__x509__raw.html">x509_raw</a>;
<a name="l00184"></a>00184 
<a name="l00185"></a>00185 <span class="preprocessor">#ifdef __cplusplus</span>
<a name="l00186"></a>00186 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> {
<a name="l00187"></a>00187 <span class="preprocessor">#endif</span>
<a name="l00188"></a>00188 <span class="preprocessor"></span>
<a name="l00199"></a>00199 <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#03e5ff0e6d5eb331b93229a1547452c5">x509parse_crt</a>( <a class="code" href="struct__x509__cert.html">x509_cert</a> *crt, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *buf, <span class="keywordtype">int</span> buflen );
<a name="l00200"></a>00200 
<a name="l00210"></a>00210 <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#58b88570dd8a4fc45468160ed2b16b96">x509parse_crtfile</a>( <a class="code" href="struct__x509__cert.html">x509_cert</a> *crt, <span class="keywordtype">char</span> *path );
<a name="l00211"></a>00211 
<a name="l00223"></a>00223 <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#62e39fbce03eae976ecb600268a3baf9">x509parse_key</a>( <a class="code" href="structrsa__context.html">rsa_context</a> *rsa,
<a name="l00224"></a>00224                    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *buf, <span class="keywordtype">int</span> buflen,
<a name="l00225"></a>00225                    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *pwd, <span class="keywordtype">int</span> pwdlen );
<a name="l00226"></a>00226 
<a name="l00236"></a>00236 <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#501db93c711e6c01915d90c89852855c">x509parse_keyfile</a>( <a class="code" href="structrsa__context.html">rsa_context</a> *rsa, <span class="keywordtype">char</span> *path, <span class="keywordtype">char</span> *password );
<a name="l00237"></a>00237 
<a name="l00242"></a>00242 <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#d8196ba713b36ef3491a80d9ec7cf1de">x509parse_dn_gets</a>( <span class="keywordtype">char</span> *buf, <span class="keywordtype">char</span> *end, <a class="code" href="struct__x509__name.html">x509_name</a> *dn );
<a name="l00243"></a>00243 
<a name="l00248"></a>00248 <span class="keywordtype">char</span> *<a class="code" href="x509_8h.html#5bebf6ca73112a68d2a747798d0ca3e0">x509parse_cert_info</a>( <span class="keywordtype">char</span> *prefix, <a class="code" href="struct__x509__cert.html">x509_cert</a> *crt );
<a name="l00249"></a>00249 
<a name="l00254"></a>00254 <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#27beec940a6053fd80454a8ec67d0640">x509parse_expired</a>( <a class="code" href="struct__x509__cert.html">x509_cert</a> *crt );
<a name="l00255"></a>00255 
<a name="l00275"></a>00275 <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#d30f18a4c188bcda0c276938b0fd05bd">x509parse_verify</a>( <a class="code" href="struct__x509__cert.html">x509_cert</a> *crt,
<a name="l00276"></a>00276                       <a class="code" href="struct__x509__cert.html">x509_cert</a> *trust_ca,
<a name="l00277"></a>00277                       <span class="keywordtype">char</span> *cn, <span class="keywordtype">int</span> *flags );
<a name="l00278"></a>00278 
<a name="l00282"></a>00282 <span class="keywordtype">void</span> <a class="code" href="x509_8h.html#5f1334782538ef0ac2ebf430b966fcc3">x509_free</a>( <a class="code" href="struct__x509__cert.html">x509_cert</a> *crt );
<a name="l00283"></a>00283 
<a name="l00289"></a>00289 <span class="keywordtype">int</span> <a class="code" href="x509_8h.html#4a038a644bb6f527315bcfdea826bf79">x509_self_test</a>( <span class="keywordtype">int</span> verbose );
<a name="l00290"></a>00290 
<a name="l00291"></a>00291 <span class="preprocessor">#ifdef __cplusplus</span>
<a name="l00292"></a>00292 <span class="preprocessor"></span>}
<a name="l00293"></a>00293 <span class="preprocessor">#endif</span>
<a name="l00294"></a>00294 <span class="preprocessor"></span>
<a name="l00295"></a>00295 <span class="preprocessor">#endif </span><span class="comment">/* x509.h */</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sun Mar 16 15:31:51 2008 for XySSL by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
